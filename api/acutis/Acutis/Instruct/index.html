<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Instruct (acutis.Acutis.Instruct)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><script>let base_url = '../../../';
let search_urls = ['../../db.js','../../../sherlodoc.js'];
</script><script src="../../../odoc.support/odoc_search.js" defer="defer"></script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">acutis</a> &#x00BB; <a href="../index.html">Acutis</a> &#x00BB; Instruct</nav><div class="odoc-search"><div class="search-inner"><input class="search-bar" placeholder="ðŸ”Ž Search..."/><div class="search-snake"></div><div class="search-result"></div></div></div><header class="odoc-preamble"><h1>Module <code><span>Acutis.Instruct</span></code></h1><p>Define the instructions to evaluate a <a href="../Compile/index.html"><code>Compile</code></a> result at runtime.</p></header><div class="odoc-content"><p>To evaluate a <a href="../Compile/index.html#type-t"><code>Compile.t</code></a>, we define an abstract language in &quot;tagless final&quot; style by using a module type. Each language construct is defined as an OCaml function so we automatically inherit the full type safety of any OCaml program.</p><p>We can evaluate the language in multiple ways. For example we can interpret it as an OCaml program, we can pretty-print it, or we can output it in a concrete language like JavaScript (which is just another form of pretty-printing). We can also add modular optimizations.</p><p>Our abstract language is roughly based on JavaScript. It has expressions, statements, loops, let-bindings, mutable references, hash tables, first-class functions, and asynchronous monads (i.e. promises).</p><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-SEM"><a href="#module-type-SEM" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-SEM/index.html">SEM</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Define the semantics of our abstract language.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Make"><a href="#module-Make" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Make/index.html">Make</a></span><span> (<a href="Make/argument-1-I/index.html">I</a> : <a href="module-type-SEM/index.html">SEM</a>) : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Create evaluation instructions for a given language implementation.</p></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-TRANS"><a href="#module-type-TRANS" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-TRANS/index.html">TRANS</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>To transform the language's output, such as for an optimization, we need to define a module that can translate terms &quot;forward&quot; to the transformed state and &quot;backward&quot; to the original representation.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-MakeTrans"><a href="#module-MakeTrans" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MakeTrans/index.html">MakeTrans</a></span><span>
  (<a href="MakeTrans/argument-1-T/index.html">T</a> : <a href="module-type-TRANS/index.html">TRANS</a>)
  (<a href="MakeTrans/argument-2-F/index.html">F</a> : <a href="module-type-SEM/index.html">SEM</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-exp">exp</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-1-T/index.html#type-from_exp">T.from_exp</a></span></span> <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-stmt">stmt</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-1-T/index.html#type-from_stmt">T.from_stmt</a></span></span>) : 
  <a href="module-type-SEM/index.html">SEM</a>
    <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-stmt">stmt</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-1-T/index.html#type-stmt">T.stmt</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-obs">obs</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-2-F/index.html#type-obs">F.obs</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-exp">exp</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-1-T/index.html#type-exp">T.exp</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-mut">mut</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-2-F/index.html#type-mut">F.mut</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-promise">promise</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-2-F/index.html#type-promise">F.promise</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-SEM/index.html#type-external_data">external_data</a> = <a href="MakeTrans/argument-2-F/index.html#type-external_data">F.external_data</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-SEM/index.html#type-import">import</a> = <a href="MakeTrans/argument-2-F/index.html#type-import">F.import</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-hashtbl">hashtbl</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-2-F/index.html#type-hashtbl">F.hashtbl</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-SEM/index.html#type-buffer">buffer</a> = <a href="MakeTrans/argument-2-F/index.html#type-buffer">F.buffer</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/index.html#type-stack">stack</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-2-F/index.html#type-stack">F.stack</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-SEM/index.html#type-error">error</a> = <a href="MakeTrans/argument-2-F/index.html#type-error">F.error</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-SEM/index.html#type-data">data</a> = <a href="MakeTrans/argument-2-F/index.html#type-data">F.data</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/External/Linear/index.html#type-t">External.Linear.t</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-2-F/External/Linear/index.html#type-t">F.External.Linear.t</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/External/Assoc/index.html#type-t">External.Assoc.t</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-2-F/External/Assoc/index.html#type-t">F.External.Assoc.t</a></span></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-SEM/External/index.html#type-classify">External.classify</a></span> = <span><span class="type-var">'a</span> <a href="MakeTrans/argument-2-F/External/index.html#type-classify">F.External.classify</a></span></span></span></code></div><div class="spec-doc"><p>Apply a transformation module and a semantics module to produce a new semantics module that uses the transformation state.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : 
  <span><span>(<span><span class="xref-unresolved">Stdlib__Format</span>.formatter <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib__Format</span>.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a0</span> <a href="../Compile/index.html#type-t">Compile.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Pretty-print the instructions for a compiled template.</p></div></div></div></body></html>

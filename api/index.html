<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>Acutis API for JavaScript &amp; ReScript</title>
    
      <meta name="description" content="The manual for the application programming interface for the Acutis template
language.
" />
    
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link rel="stylesheet" href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis/style.css" />
  </head>
  <body>
    <a class="skip-nav" href="#content">Skip to content.</a><div class="site-header__wrapper">
        <header><p class="site-header__title">
              <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis/">Acutis</a>
            </p><p class="site-header__subtitle">a template language for the web &amp; beyond</p>
        </header>
        <nav class="site-header__nav">
          <ol class="site-header__nav-list"><li>
                <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis&#x2F;" aria-current="false">
  Home
</a>
              </li><li>
                <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis&#x2F;introduction&#x2F;" aria-current="false">
  Getting started
</a>
              </li><li>
                <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis&#x2F;manual&#x2F;" aria-current="false">
  Language manual
</a>
              </li><li>
                <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis&#x2F;api&#x2F;" aria-current="true">
  API
</a>
              </li><li>
                <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis&#x2F;playground&#x2F;" aria-current="false">
  Playground
</a>
              </li><li>
                <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis&#x2F;development&#x2F;" aria-current="false">
  Development
</a>
              </li><li>
                <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis&#x2F;credits&#x2F;" aria-current="false">
  Credits
</a>
              </li></ol>
        </nav>
      </div><main class="main" id="content">
      <article>
          <header class="header">
            <h1>Acutis API for JavaScript &amp; ReScript</h1>
          </header><p>An Acutis template tree is rendered using a <em>source string</em>, a <em>props
object</em>, a <em>render context function</em>, and an <em>object with template
components</em>.</p>
<p>Template sources are compiled into functions. These functions are then executed
with their props and a render context function, which produces the final output.</p>
<p><div class="table-of-contents"><details open><summary class="toc-container-header">Contents</summary><ol><li><a href="#example-code">Example code</a><ol><li><a href="#javascript">JavaScript</a></li><li><a href="#rescript">ReScript</a></li></ol></li><li><a href="#function-reference">Function reference</a><ol><li><a href="#compile"><code>compile</code></a></li><li><a href="#rendercontext"><code>renderContext</code></a></li><li><a href="#rendercontextasync"><code>renderContextAsync</code></a></li></ol></li><li><a href="#how-to-handle-the-output">How to handle the output</a><ol><li><a href="#javascript%3A-%7B-name%2C-val-%7D">JavaScript: <code>{ NAME, VAL }</code></a></li><li><a href="#rescript%3A-%5B%23data('a)-%7C-%23errors('e)%5D">ReScript: <code>[#data('a) | #errors('e)]</code></a></li><li><a href="#handling-errors">Handling errors</a></li></ol></li><li><a href="#template-functions-overview">Template functions overview</a></li><li><a href="#template-component-functions">Template component functions</a><ol><li><a href="#makeast"><code>makeAst</code></a></li><li><a href="#synchronous-and-asynchronous-templates">Synchronous and asynchronous templates</a></li><li><a href="#using-the-children-argument">Using the children argument</a></li></ol></li><li><a href="#node-helpers-api">Node helpers API</a><ol><li><a href="#loadtemplate"><code>loadTemplate</code></a></li><li><a href="#filenametocomponent"><code>filenameToComponent</code></a></li></ol></li><li><a href="#acutis-command-line-interface-(cli)">Acutis command line interface (CLI)</a></li></ol></details></div></p>
<h2 id="example-code">Example code</h2>
<h3 id="javascript">JavaScript</h3>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> compile<span class="token punctuation">,</span> renderContext <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acutis-lang"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"Hello {{ name }}."</span><span class="token punctuation">,</span> module<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> footer <span class="token operator">=</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"Copyright 2020."</span><span class="token punctuation">,</span> <span class="token string">"Footer"</span><span class="token punctuation">)</span><br><span class="token keyword">const</span> render <span class="token operator">=</span> <span class="token function">renderContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span>Footer<span class="token operator">:</span> footer<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">"Carlo"</span><span class="token punctuation">}</span><br><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span>render<span class="token punctuation">,</span> props<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token constant">NAME</span> <span class="token operator">===</span> <span class="token string">"errors"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token constant">VAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token constant">VAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Logs: "Hello Carlo."</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="rescript">ReScript</h3>
<pre class="language-reason"><code class="language-reason"><span class="token keyword">open</span> <span class="token constructor variable">Acutis</span><br><span class="token keyword">let</span> template <span class="token operator">=</span> <span class="token class-name">Compile</span><span class="token punctuation">.</span>make<span class="token punctuation">(</span><span class="token string">"Hello {{ name }}."</span><span class="token punctuation">,</span> __FILE__<span class="token punctuation">)</span><br><span class="token keyword">let</span> footer <span class="token operator">=</span> <span class="token class-name">Compile</span><span class="token punctuation">.</span>make<span class="token punctuation">(</span><span class="token string">"Copyright 2020."</span><span class="token punctuation">,</span> <span class="token string">"Footer"</span><span class="token punctuation">)</span><br><span class="token keyword">let</span> render <span class="token operator">=</span> <span class="token class-name">Render</span><span class="token punctuation">.</span>makeContext<span class="token punctuation">(</span><span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Dict</span><span class="token punctuation">.</span>fromArray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"Footer"</span><span class="token punctuation">,</span> footer<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token keyword">let</span> props <span class="token operator">=</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Dict</span><span class="token punctuation">.</span>fromArray<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"Carlo"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token keyword">switch</span> template<span class="token punctuation">(</span><span class="token punctuation">.</span> render<span class="token punctuation">,</span> props<span class="token punctuation">,</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Dict</span><span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br><span class="token operator">|</span> <span class="token operator">#</span>data<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment">// Logs: "Hello Carlo."</span><br><span class="token operator">|</span> <span class="token operator">#</span>errors<span class="token punctuation">(</span>errors<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Console</span><span class="token punctuation">.</span>error<span class="token punctuation">(</span>errors<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre>
<h2 id="function-reference">Function reference</h2>
<h3 id="compile"><code>compile</code></h3>
<p>The <code>compile</code> function (<code>Compile.make</code> in ReScript) compiles a string into a
template function. It can optionally accept a string name for debugging. See
<a href="#template-functions-overview">template functions</a> to read about how these work.</p>
<h4 id="javascript-example">JavaScript example</h4>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> compile <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acutis-lang"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"Hello {{ name }}."</span><span class="token punctuation">,</span> module<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4 id="rescript-example">ReScript example</h4>
<pre class="language-reason"><code class="language-reason"><span class="token keyword">open</span> <span class="token constructor variable">Acutis</span><br><span class="token keyword">let</span> template <span class="token operator">=</span> <span class="token class-name">Compile</span><span class="token punctuation">.</span>make<span class="token punctuation">(</span><span class="token string">"Hello {{ name }}."</span><span class="token punctuation">,</span> <span class="token operator">~</span>name<span class="token operator">=</span>__FILE__<span class="token punctuation">)</span></code></pre>
<p>⚠️ In ReScript, the function returned by <code>Compile.make</code> is <a href="https://rescript-lang.org/docs/manual/latest/function#uncurried-function">uncurried</a>.</p>
<h3 id="rendercontext"><code>renderContext</code></h3>
<p>The <code>renderContext</code> function (<code>Render.makeContext</code> in ReScript) accepts an
object with all of the template components. This makes our template
components global across all templates in the render tree. It returns the
function used to actually render the compiled templates.</p>
<h4 id="javascript-example-1">JavaScript example</h4>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> compile<span class="token punctuation">,</span> renderContext <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acutis-lang"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token string">"Footer"</span><span class="token operator">:</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"Copyright 2020."</span><span class="token punctuation">,</span> <span class="token string">"Footer"</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> render <span class="token operator">=</span> <span class="token function">renderContext</span><span class="token punctuation">(</span>components<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4 id="rescript-example-1">ReScript example</h4>
<pre class="language-reason"><code class="language-reason"><span class="token keyword">open</span> <span class="token constructor variable">Acutis</span><br><span class="token keyword">let</span> components <span class="token operator">=</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Dict</span><span class="token punctuation">.</span>fromArray<span class="token punctuation">(</span><span class="token punctuation">[</span><br>  <span class="token punctuation">(</span><span class="token string">"Footer"</span><span class="token punctuation">,</span> <span class="token class-name">Compile</span><span class="token punctuation">.</span>make<span class="token punctuation">(</span><span class="token string">"Copyright 2020."</span><span class="token punctuation">,</span> <span class="token operator">~</span>name<span class="token operator">=</span><span class="token string">"Footer"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token keyword">let</span> render <span class="token operator">=</span> <span class="token class-name">Render</span><span class="token punctuation">.</span>makeContext<span class="token punctuation">(</span>components<span class="token punctuation">)</span></code></pre>
<h3 id="rendercontextasync"><code>renderContextAsync</code></h3>
<p>The <code>renderContextAsync</code> function (<code>Render.makeContextAsync</code> in ReScript)
works identically to <code>renderContext</code> except that it returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a> of
the result. Use this if you have <a href="#template-functions-overview">template functions</a> that require
asynchronous logic.</p>
<h2 id="how-to-handle-the-output">How to handle the output</h2>
<p>The data returned by a template can either contain the rendered output or an
array of error messages. How you use this data will be different depending on
whether you’re using JavaScript or ReScript.</p>
<p>If you’re using asynchronous templates, then the output will always be
wrapped inside a resolved promise. Acutis makes sure that promises never
reject since it captures any errors inside the output.</p>
<h3 id="javascript%3A-%7B-name%2C-val-%7D">JavaScript: <code>{ NAME, VAL }</code></h3>
<p>Acutis returns data inside an object with <code>NAME</code> and <code>VAL</code> properties. If any
errors occurred, then <code>NAME</code> will be <code>&quot;errors&quot;</code> and <code>VAL</code> will be an array of
the errors. If no errors occurred, then <code>NAME</code> will be <code>&quot;data&quot;</code> and <code>VAL</code> will
be the rendered output.</p>
<h4 id="example-successful-output">Example successful output</h4>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"NAME"</span><span class="token operator">:</span> <span class="token string">"data"</span><span class="token punctuation">,</span><br>  <span class="token property">"VAL"</span><span class="token operator">:</span> <span class="token string">"The content of your output."</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="example-unsuccessful-output">Example unsuccessful output</h4>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"NAME"</span><span class="token operator">:</span> <span class="token string">"errors"</span><span class="token punctuation">,</span><br>  <span class="token property">"VAL"</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>    <span class="token punctuation">{</span> <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"An object with error details goes here."</span> <span class="token punctuation">}</span><br>  <span class="token punctuation">]</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="example-usage">Example usage</h4>
<pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token constant">NAME</span> <span class="token operator">===</span> <span class="token string">"errors"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token constant">VAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token constant">VAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="rescript%3A-%5B%23data('a)-%7C-%23errors('e)%5D">ReScript: <code>[#data('a) | #errors('e)]</code></h3>
<p>In ReScript, the output uses a polymorphic variant defined as <code>[#data('a) | #errors('e)]</code>. You can use <code>switch</code> with it like any variant.</p>
<pre class="language-reason"><code class="language-reason"><span class="token keyword">switch</span> result <span class="token punctuation">{</span><br><span class="token operator">|</span> <span class="token operator">#</span>data<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token class-name">Js</span><span class="token punctuation">.</span>log<span class="token punctuation">(</span>data<span class="token punctuation">)</span><br><span class="token operator">|</span> <span class="token operator">#</span>errors<span class="token punctuation">(</span>errors<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Console</span><span class="token punctuation">.</span>error<span class="token punctuation">(</span>errors<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="handling-errors">Handling errors</h3>
<p>In either language, errors are represented the same. Here’s an example error
message:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"kind"</span><span class="token operator">:</span> <span class="token string">"Syntax"</span><span class="token punctuation">,</span><br>  <span class="token property">"location"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"character"</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"Invalid character: \"*\"."</span><span class="token punctuation">,</span><br>  <span class="token property">"template"</span><span class="token operator">:</span> <span class="token string">"TemplateName"</span><br><span class="token punctuation">}</span></code></pre>
<p>Any of these fields may not be present if there isn’t any data for them. If
an exception was thrown while rendering, then it will be caught and added to
an <code>exn</code> field.</p>
<p>When Acutis encounters an error, it will try to keep processing the template
and report as many errors as it can find. But as long as there is at least
one error, then it won’t return any rendered data.</p>
<h2 id="template-functions-overview">Template functions overview</h2>
<p>Templates returned by <code>compile</code> are functions that accept three arguments:</p>
<ol>
<li>The render context function, created by <code>renderContext</code>.</li>
<li>A props object.</li>
<li>A children object.</li>
</ol>
<p>The children argument is similar to the props, except it contains rendered
template sections. You’ll typically pass an empty object (<code>{}</code>) to this from
your top-level template. See <a href="#using-the-children-argument">using the <code>children</code> argument</a> for more
information about this.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span>renderContext<span class="token punctuation">,</span> props<span class="token punctuation">,</span> children<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 id="template-component-functions">Template component functions</h2>
<p>Because templates are just functions, we can write them manually with custom
JavaScript. Any functions we write will need to adhere to the same signature
as the functions created by <code>compile</code>.</p>
<p>The render context function (taken from the first argument) accepts three
arguments: a low-level abstract syntax tree (AST), a props object , and the
optional children object.</p>
<p>⚠️ In ReScript, these functions must be <a href="https://rescript-lang.org/docs/manual/latest/function#uncurried-function">uncurried</a>.</p>
<h3 id="makeast"><code>makeAst</code></h3>
<p>The <code>makeAst</code> function (<code>Compile.makeAst</code> in ReScript) is part of the
low-level API that produces the raw AST for a template.</p>
<p>Suppose we want a <code>Footer</code> template that will always return the current year.
We can write a template to similar to the following.</p>
<h4 id="javascript-example-2">JavaScript example</h4>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> makeAst <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"acutis-lang"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> ast <span class="token operator">=</span> <span class="token function">makeAst</span><span class="token punctuation">(</span><span class="token string">"Copyright {{ year }}"</span><span class="token punctuation">,</span> module<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">function</span> <span class="token function">Footer</span><span class="token punctuation">(</span><span class="token parameter">render<span class="token punctuation">,</span> props<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token punctuation">{</span>year<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token function">render</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> props<span class="token punctuation">,</span> children<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="rescript-example-2">ReScript example</h4>
<pre class="language-reason"><code class="language-reason"><span class="token keyword">let</span> ast <span class="token operator">=</span> <span class="token class-name">Acutis</span><span class="token punctuation">.</span><span class="token class-name">Compile</span><span class="token punctuation">.</span>makeAst<span class="token punctuation">(</span><span class="token string">"Copyright {{ year }}"</span><span class="token punctuation">,</span> __FILE__<span class="token punctuation">)</span><br><span class="token keyword">let</span> footer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">.</span> render<span class="token punctuation">,</span> props<span class="token punctuation">,</span> children<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">let</span> props <span class="token operator">=</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Dict</span><span class="token punctuation">.</span>fromArray<span class="token punctuation">(</span><span class="token punctuation">[</span><br>    <span class="token punctuation">(</span><span class="token string">"year"</span><span class="token punctuation">,</span> <span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Date</span><span class="token punctuation">.</span>make<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token class-name">Js</span><span class="token punctuation">.</span><span class="token class-name">Date</span><span class="token punctuation">.</span>getFullYear<span class="token punctuation">)</span><br>  <span class="token punctuation">]</span><span class="token punctuation">)</span><br>  render<span class="token punctuation">(</span>ast<span class="token punctuation">,</span> props<span class="token punctuation">,</span> children<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="synchronous-and-asynchronous-templates">Synchronous and asynchronous templates</h3>
<p>If you have a template function that uses <code>async</code> functions or promises, then
you need to render your whole template tree with an asynchronous render
context.</p>
<p>Templates components inherit their context from their parent templates, so
synchronous templates can be used interchangeably between context types. This
does not work the other way around, though. Asynchronous templates cannot be
made synchronous.</p>
<h3 id="using-the-children-argument">Using the children argument</h3>
<p>You will usually not need to directly manipulate the children argument, or
often you can just pass an empty object (<code>{}</code>) as children.</p>
<p><a href="../manual/#template-children-props">Template components can accept template sections as children props</a>, but
these are not interchangeable with pattern props. Therefore, Acutis keeps
rendered template children in a separate object.</p>
<p>If you are manually rendering a template section within a function, then make
sure you pass it to the children argument.</p>
<h2 id="node-helpers-api">Node helpers API</h2>
<p>Acutis includes functions for rendering templates in a Node.js environment,
such as for a static site generator. They can be imported from module
<code>acutis-lang/node-utils</code>.</p>
<h3 id="loadtemplate"><code>loadTemplate</code></h3>
<p>Calling <code>loadTemplate(fileName)</code> will return a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a> of a template
function.</p>
<ul>
<li>If the filename ends with a <code>.js</code> extension, then it will load it with
<code>require</code>.</li>
<li>If the filename ends with a <code>.mjs</code> extension, then it will load it
with dynamic <code>import</code>.</li>
</ul>
<p>For both of those cases, it uses the “default” export as the template
function.</p>
<p>For all other file extension, it loads the file’s text content as the
template.</p>
<h3 id="filenametocomponent"><code>filenameToComponent</code></h3>
<p>Calling <code>filenameToComponent(fileName)</code> strips the extension and capitalizes
the first letter. Example: <code>filenameToComponent(&quot;footer.js&quot;)</code> returns
<code>&quot;Footer&quot;</code>. This is just a convenience to help components adhere to template
naming rules.</p>
<h2 id="acutis-command-line-interface-(cli)">Acutis command line interface (CLI)</h2>
<p>You can use Acutis from the command line. It accepts JSON data and an array
of template filenames, and it prints the rendered output.</p>
<pre class="language-shell"><code class="language-shell">acutis Index.acutis src/**/*.<span class="token punctuation">(</span>js<span class="token operator">|</span>mjs<span class="token operator">|</span>acutis<span class="token punctuation">)</span> <span class="token operator">&lt;</span> data.json <span class="token operator">></span> dist/index.html</code></pre>
<p>Full options:</p>
<pre class="language-html"><code class="language-html">Usage:<br>  acutis [options] [template] [templates...]<br><br>Options:<br>  -a, --async                   Enable asynchronous templates. Default: false.<br>  -d, --data                    The path to the JSON data file. Default: stdin.<br>  -o, --output                  The path to write the output. Default: stdout.<br>  -t, --table                   Print errors in a table. Default: false.<br>  -h, --help                    Show this message and exit.<br>  -v, --version                 Show the version and exit.<br><br>Templates:<br>  The first template listed is the root template. Templates with .js or .mjs<br>  extensions are rendered using their default export function. For all other<br>  file types, their text content is used as the template.<br><br>Examples:<br>  acutis --data=data.json --output=index.html Index.acutis Header.js Footer.acutis<br>  acutis Index.acutis _includes/**/*.(js|mjs|acutis) &lt; data.json > index.html<br>  curl https://example.com/api | acutis Index.acutis *.(js|acutis) -o index.html </code></pre>

      </article>
    </main><footer class="footer">
  <p>
    Published in 2020 by <a href="https:&#x2F;&#x2F;johnridesa.bike">John Jackson</a>.
  </p>
  <p class="footer__license">
    <a href="https:&#x2F;&#x2F;johnridesa.bike&#x2F;acutis/license/">View the license</a>.
  </p>
</footer>
</body>
</html>
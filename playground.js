var Nt=Object.defineProperty;var hr=(r,e)=>{for(var t in e)Nt(r,t,{get:e[t],enumerable:!0})};var Qr={};hr(Qr,{flatMap:()=>Ir,flatMapU:()=>Ee,getExn:()=>Dt,getOrElse:()=>St,getOrElseU:()=>cr,map:()=>pr,mapU:()=>D});function Rr(r,e,t){for(var n=new Array(t),u=0,a=e;u<t;)n[u]=r[a],u=u+1|0,a=a+1|0;return n}function lr(r,e){for(;;){var t=e,n=r,u=n.length,a=u===0?1:u,i=t.length,o=a-i|0;if(o===0)return n.apply(null,t);if(o>=0)return function(f,l){return function(c){return lr(f,l.concat([c]))}}(n,t);e=Rr(t,a,-o|0),r=n.apply(null,Rr(t,0,a))}}function fr(r,e){var t=r.length;if(t===1)return r(e);switch(t){case 1:return r(e);case 2:return function(n){return r(e,n)};case 3:return function(n,u){return r(e,n,u)};case 4:return function(n,u,a){return r(e,n,u,a)};case 5:return function(n,u,a,i){return r(e,n,u,a,i)};case 6:return function(n,u,a,i,o){return r(e,n,u,a,i,o)};case 7:return function(n,u,a,i,o,f){return r(e,n,u,a,i,o,f)};default:return lr(r,[e])}}function I(r){var e=r.length;return e===1?r:function(t){return fr(r,t)}}function kt(r,e,t,n){var u=r.length;if(u===3)return r(e,t,n);switch(u){case 1:return lr(r(e),[t,n]);case 2:return lr(r(e,t),[n]);case 3:return r(e,t,n);case 4:return function(a){return r(e,t,n,a)};case 5:return function(a,i){return r(e,t,n,a,i)};case 6:return function(a,i,o){return r(e,t,n,a,i,o)};case 7:return function(a,i,o,f){return r(e,t,n,a,i,o,f)};default:return lr(r,[e,t,n])}}function $(r){var e=r.length;return e===3?r:function(t,n,u){return kt(r,t,n,u)}}function D(r,e){return r.NAME==="ok"?{NAME:"ok",VAL:e(r.VAL)}:r}function pr(r,e){return D(r,I(e))}function Ee(r,e){return r.NAME==="ok"?e(r.VAL):r}function Ir(r,e){return Ee(r,I(e))}function Dt(r){if(r.NAME==="ok")return r.VAL;throw{RE_EXN_ID:"Not_found",Error:new Error}}function cr(r,e){return r.NAME==="ok"?r.VAL:e(r.VAL)}function St(r,e){return cr(r,I(e))}var Gr={};hr(Gr,{func:()=>Qt,funcWithString:()=>It,name:()=>er,string:()=>Rt});function Rt(r,e){return{TAG:0,name:r,src:e}}function Qt(r,e){return{TAG:1,name:r,f:e}}function It(r,e,t){return{TAG:2,name:r,src:e,f:t}}function er(r){return r.name}var ie={};hr(ie,{Components:()=>Fn,Pattern:()=>$n,make:()=>Wn,makeAstInternalExn:()=>le});function w(r){return r===void 0?{BS_PRIVATE_NESTED_SOME_NONE:0}:r!==null&&r.BS_PRIVATE_NESTED_SOME_NONE!==void 0?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function T(r){if(!(r!==null&&r.BS_PRIVATE_NESTED_SOME_NONE!==void 0))return r;var e=r.BS_PRIVATE_NESTED_SOME_NONE;if(e!==0)return{BS_PRIVATE_NESTED_SOME_NONE:e-1|0}}function be(r,e){return r>e?r:e}function S(r,e){if(e>=0&&e<r.length)return w(r[e])}function Be(r,e){for(var t=r.length,n=e.length,u=new Array(t+n|0),a=0;a<t;++a)u[a]=r[a];for(var i=0;i<n;++i)u[t+i|0]=e[i];return u}function Me(r,e){for(var t=r.length,n=e<0?be(t+e|0,0):e,u=t-n|0,a=new Array(u),i=0;i<u;++i)a[i]=r[n+i|0];return a}function F(r,e){for(var t=0,n=r.length;t<n;++t)e(r[t])}function V(r,e){for(var t=r.length,n=new Array(t),u=0;u<t;++u)n[u]=e(r[u]);return n}function jr(r,e){for(var t=0,n=r.length;t<n;++t)e(t,r[t])}function Gt(r){for(var e=r,t=0;;){var n=t,u=e;if(!u)return n;t=n+1|0,e=u.tl}}function jt(r,e,t){for(;;){var n=t,u=e;if(!n)return;r[u]=n.hd,t=n.tl,e=u+1|0}}function k(r){var e=Gt(r),t=new Array(e);return jt(t,0,r),t}function we(r,e,t){for(;;){var n=r;if(!n)return!1;if(t(n.hd,e))return!0;r=n.tl}}var Or={contents:0};function gr(r){return Or.contents=Or.contents+1|0,r+("/"+Or.contents)}function Te(r){return r==null?!1:typeof r.RE_EXN_ID=="string"}function Ot(r,e){return{_0:e(r._0),_1:V(r._1,e)}}var vr={map:Ot};function Wt(r){switch(r.TAG|0){case 0:return"[text]: "+r._1;case 1:return"{*"+r._1+"*}";case 2:return'"'+r._1+'"';case 3:return String(r._1);case 4:return"true";case 5:return"false";case 6:return"null";case 7:return",";case 8:return":";case 9:return"[";case 10:return"]";case 11:return"{";case 12:return"}";case 13:return"...";case 15:return"/";case 16:return"#";case 17:return"=";case 14:case 18:return r._1;case 19:return"~";case 20:return"?";case 21:return"&";case 22:return"{{";case 23:return"[end of file]"}}function $t(r){return r._0}var Wr={toString:Wt,toLocation:$t};function Ft(r){var e=r.NAME;return e==="Object"?"object":e==="Binding"?"binding: `"+r.VAL[1]+"`":e==="Number"?"number":e==="True"||e==="False"?"boolean":e==="Array"||e==="ArrayWithTailBinding"?"array":e==="Null"?"null":"string"}function Pt(r){var e=r.NAME;return e==="True"||e==="Null"||e==="False"?r.VAL:r.VAL[0]}var K={toString:Ft,toLocation:Pt};function R(r){if(typeof r=="number")return r===0?"match":"map";switch(r.TAG|0){case 1:return"section: "+r.component+"#"+r.section;case 0:case 2:return r._0}}var A=gr("Debug-AcutisLang.Exit");function Ce(r,e){return{message:"Unexpected end of file.",kind:"Syntax",location:{character:r+1|0},path:[e],exn:void 0}}function Ve(r,e){return{message:"Unterminated comment.",kind:"Syntax",location:{character:r+1|0},path:[e],exn:void 0}}function Ue(r,e){return{message:"Unterminated string.",kind:"Syntax",location:{character:r+1|0},path:[e],exn:void 0}}function xe(r,e,t){return{message:'"'+t+'" is an illegal identifier name.',kind:"Syntax",location:{character:r+1|0},path:[e],exn:void 0}}function Ne(r,e,t){return{message:'Invalid character: "'+t+'".',kind:"Syntax",location:{character:r+1|0},path:[e],exn:void 0}}function yr(r,e,t,n){return{message:'Unexpected character: "'+t+'". Expected: "'+n+'".',kind:"Syntax",location:{character:r+1|0},path:[e],exn:void 0}}function L(r,e){var t=Wr.toLocation(r);return{message:'Unexpected token: "'+Wr.toString(r)+'".',kind:"Parse",location:{character:t+1|0},path:[e],exn:void 0}}function ke(r,e){var t=K.toLocation(r);return{message:'Bad map type: "'+K.toString(r)+'". I can only map bindings and arrays.',kind:"Parse",location:{character:t+1|0},path:[e],exn:void 0}}function De(r){return r}function Se(r,e,t){return{message:"Cyclic dependency detected. I can't compile any components in this path.",kind:"Compile",location:{character:r+1|0},path:V(k({hd:e,tl:t}),De),exn:void 0}}function Re(r,e,t){return{message:'Component "'+e+`" either does not exist or couldn't be compiled.`,kind:"Compile",location:{character:r+1|0},path:V(k(t),De),exn:void 0}}function Qe(r){return{message:'The template component name "'+r+'" was used twice. Every component needs a unique name.',kind:"Compile",location:void 0,path:[],exn:void 0}}function Ie(r,e){return{message:"An exception was thrown while compiling this template. This is probably due to malformed input.",kind:"Compile",location:void 0,path:[e],exn:w(r)}}function Lr(r){if(typeof r=="number")switch(r){case 0:case 1:return"boolean";case 2:return"null"}else switch(r.TAG|0){case 0:return"string";case 1:return"number";case 2:return"object";case 3:return"array"}}function Ge(r,e,t){var n=Lr(r),u=K.toString(e),a=K.toLocation(e);return{message:"This pattern is type "+u+" but the data is type "+n+".",kind:"Type",location:{character:a+1|0},path:V(k(t),R),exn:void 0}}function je(r,e,t,n){var u=Lr(r),a=K.toString(e),i=K.toLocation(e);return{message:'"'+t+'" is type '+a+" but the data is type "+u+".",kind:"Type",location:{character:i+1|0},path:V(k(n),R),exn:void 0}}function Oe(r,e,t){return{message:'"'+e+'" is bound multiple times in this pattern.',kind:"Pattern",location:{character:r+1|0},path:V(k(t),R),exn:void 0}}function We(r,e){return{message:"None of the patterns match the data. Consider a catch-all case to avoid this.",kind:"Pattern",location:{character:r+1|0},path:V(k(e),R),exn:void 0}}function $e(r,e){return{message:"The number of patterns does not match the number of data.",kind:"Pattern",location:{character:r+1|0},path:V(k(e),R),exn:void 0}}function Fe(r,e,t,n){var u=Lr(t);return{message:'"'+e+'" is type '+u+". I can only echo strings and numbers.",kind:"Render",location:{character:r+1|0},path:V(k(n),R),exn:void 0}}function $r(r,e,t){return{message:'Binding "'+e+'" does not exist.',kind:"Render",location:{character:r+1|0},path:V(k(t),R),exn:void 0}}function Fr(r,e,t){return{message:'Template child "'+e+'" does not exist.',kind:"Render",location:{character:r+1|0},path:V(k(t),R),exn:void 0}}function Pe(r,e,t,n){var u=Lr(t);return{message:'"'+e+'" is a '+u+". I can only map arrays.",kind:"Type",location:{character:r+1|0},path:V(k(n),R),exn:void 0}}function Je(r,e){return{message:"An exception was thrown while rendering a template component.",kind:"Render",location:void 0,path:V(k(e),R),exn:w(r)}}function Pr(r,e){return{message:r,kind:"Render",location:void 0,path:V(k(e),R),exn:void 0}}function Ke(r){var e=parseFloat(r);if(!isNaN(e))return e}function E(r){return{length:0,first:void 0,last:void 0}}function Jr(r){r.length=0,r.first=void 0,r.last=void 0}function v(r,e){var t={content:e,next:void 0},n=r.last;n!==void 0?(r.length=r.length+1|0,n.next=t,r.last=t):(r.length=1,r.first=t,r.last=t)}function ze(r){var e=r.first;if(e!==void 0)return e.content;throw{RE_EXN_ID:"Not_found",Error:new Error}}function Xe(r){var e=r.first;if(e!==void 0){var t=e.next;return t===void 0?(Jr(r),e.content):(r.length=r.length-1|0,r.first=t,e.content)}throw{RE_EXN_ID:"Not_found",Error:new Error}}function z(r){return r.length===0}function sr(r,e){for(var t=r.first;;){var n=t;if(n===void 0)return;e(n.content),t=n.next}}function O(r,e){if(!(r.length<=0)){var t=e.last;return t!==void 0?(e.length=e.length+r.length|0,t.next=r.first,e.last=r.last,Jr(r)):(e.length=r.length,e.first=r.first,e.last=r.last,Jr(r))}}function Jt(r,e,t){for(;;){var n=t,u=r;if(n===void 0)return;e[u]=n.content,t=n.next,r=u+1|0}}function p(r){var e=new Array(r.length);return Jt(0,e,r.first),e}function X(r){for(var e={length:0,first:void 0,last:void 0},t=0,n=r.length;t<n;++t)v(e,r[t]);return e}function H(r,e){return r.str.charAt(r.position+e|0)}function Kr(r){return r.str.charAt(r.position)}function M(r){r.position=r.position+1|0}function He(r){var e=Kr(r);return M(r),e}function Kt(r,e){for(var t=r.position;!e(r.str.charAt(t));)t=t+1|0;return t}function Er(r,e){r.position=r.position+e|0}function zr(r,e){var t=r.position,n=Kt(r,e);return r.position=n,r.str.slice(t,n)}function Z(r,e){var t=r.position;return r.position=r.position+e|0,r.str.slice(t,r.position)}function zt(r){switch(r){case"+":case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"E":case"e":return!1;default:return!0}}function br(r,e){for(var t=r.position,n=0;;){var u=n,a=H(r,u);switch(a){case"":return v(e,{TAG:0,_0:t,_1:Z(r,u)}),3;case"{":var i=H(r,u+1|0);switch(i){case"%":return v(e,{TAG:0,_0:t,_1:Z(r,u)}),Er(r,2),1;case"*":return v(e,{TAG:0,_0:t,_1:Z(r,u)}),Er(r,2),2;case"{":return v(e,{TAG:0,_0:t,_1:Z(r,u)}),Er(r,2),0;default:n=u+2|0;continue}default:n=u+1|0;continue}}}function Xt(r,e){for(var t=r.position,n=0,u=0;;){var a=u,i=n,o=H(r,i);switch(o){case"":throw{RE_EXN_ID:A,_1:Ve(t,e),Error:new Error};case"*":var f=H(r,i+1|0);if(f==="}"){if(a===0){var l=Z(r,i);return Er(r,2),l}u=a-1|0,n=i+2|0;continue}n=i+2|0;continue;case"{":var c=H(r,i+1|0);if(c==="*"){u=a+1|0,n=i+2|0;continue}n=i+1|0;continue;default:n=i+1|0;continue}}}var Ht=/\\"/g;function Zt(r,e){for(var t=r.position,n=0;;){var u=n,a=H(r,u);switch(a){case"":throw{RE_EXN_ID:A,_1:Ue(t,e),Error:new Error};case'"':var i=Z(r,u).replace(Ht,'"');return M(r),i;case"\\":var o=H(r,u+1|0);switch(o){case'"':case"\\":n=u+2|0;continue;default:n=u+1|0;continue}default:n=u+1|0;continue}}}function Yt(r,e){var t=r.position,n=zr(r,zt),u=Ke(n);if(u!==void 0)return u;throw{RE_EXN_ID:A,_1:xe(t,e,n),Error:new Error}}var qt=/^[a-zA-Z0-9_]$/;function Ze(r){return!qt.test(r)}var rn=/^[a-z_]$/,en=/^[A-Z]$/;function tn(r,e){var t=zr(r,Ze);switch(t){case"false":return{TAG:5,_0:e};case"null":return{TAG:6,_0:e};case"true":return{TAG:4,_0:e};default:return{TAG:18,_0:e,_1:t}}}function Ye(r,e,t,n){for(var u=!0;u;){var a=r.position,i=Kr(r),o=0;if(i===n)M(r),u=!1;else switch(i){case"":throw{RE_EXN_ID:A,_1:Ce(a,t),Error:new Error};case"	":case`
`:case"\r":case" ":M(r);break;case'"':M(r),v(e,{TAG:2,_0:a,_1:Zt(r,t)});break;case"#":M(r),v(e,{TAG:16,_0:a});break;case"&":M(r),v(e,{TAG:21,_0:a});break;case",":M(r),v(e,{TAG:7,_0:a});break;case".":var f=Z(r,3);if(f==="...")v(e,{TAG:13,_0:a});else throw{RE_EXN_ID:A,_1:yr(a,t,f,"..."),Error:new Error};break;case"/":M(r),v(e,{TAG:15,_0:a});break;case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":o=1;break;case":":M(r),v(e,{TAG:8,_0:a});break;case"=":M(r),v(e,{TAG:17,_0:a});break;case"?":M(r),v(e,{TAG:20,_0:a});break;case"[":M(r),v(e,{TAG:9,_0:a});break;case"]":M(r),v(e,{TAG:10,_0:a});break;case"{":M(r),v(e,{TAG:11,_0:a});break;case"}":M(r),v(e,{TAG:12,_0:a});break;case"~":M(r),v(e,{TAG:19,_0:a});break;default:if(rn.test(i))v(e,tn(r,a));else if(en.test(i))v(e,{TAG:14,_0:a,_1:zr(r,Ze)});else throw{RE_EXN_ID:A,_1:Ne(a,t,i),Error:new Error}}o===1&&v(e,{TAG:3,_0:a,_1:Yt(r,t)})}}function qe(r,e){for(var t={str:e,position:0},n=E(void 0),u=br(t,n);;){var a=u;switch(a){case 0:var i=t.position;Kr(t)==="~"&&(v(n,{TAG:19,_0:t.position}),M(t)),v(n,{TAG:22,_0:i}),Ye(t,n,r,"}");var o=He(t);if(o==="}"){u=br(t,n);continue}throw{RE_EXN_ID:A,_1:yr(t.position,r,o,"}"),Error:new Error};case 1:Ye(t,n,r,"%");var f=He(t);if(f==="}"){u=br(t,n);continue}throw{RE_EXN_ID:A,_1:yr(t.position,r,f,"}"),Error:new Error};case 2:var l=t.position;v(n,{TAG:1,_0:l,_1:Xt(t,r)}),u=br(t,n);continue;case 3:return v(n,{TAG:23,_0:t.position}),{tokens:n,name:r}}}}function Br(r){return ze(r.tokens)}function s(r){return Xe(r.tokens)}function y(r){return r.name}var nn=gr("Caml_js_exceptions.Error");function Mr(r){return Te(r)?r:{RE_EXN_ID:nn,_1:r}}function U(r){return r!==void 0?r.h:0}function G(r,e,t,n){var u=U(r),a=U(n);return{k:e,v:t,h:u>=a?u+1|0:a+1|0,l:r,r:n}}function nr(r,e){return{k:r,v:e,h:1,l:void 0,r:void 0}}function rt(r,e){return e!==void 0?r!==void 0?r.h>=e.h:!1:!0}function Xr(r,e){return r.v===e?r:{k:r.k,v:e,h:r.h,l:r.l,r:r.r}}function wr(r,e,t,n){var u=r!==void 0?r.h:0,a=n!==void 0?n.h:0;if(u>(a+2|0)){var i=r.l,o=r.r;return U(i)>=U(o)?G(i,r.k,r.v,G(o,e,t,n)):G(G(i,r.k,r.v,o.l),o.k,o.v,G(o.r,e,t,n))}if(a<=(u+2|0))return{k:e,v:t,h:u>=a?u+1|0:a+1|0,l:r,r:n};var f=n.l,l=n.r;return U(l)>=U(f)?G(G(r,e,t,f),n.k,n.v,l):G(G(r,e,t,f.l),f.k,f.v,G(f.r,n.k,n.v,l))}function an(r){for(;;){var e=r,t=e.l;if(t===void 0)return[e.k,e.v];r=t}}function Hr(r){if(r!==void 0)return an(r)}function Tr(r,e){for(;;){var t=r;if(t===void 0)return;Tr(t.l,e),e(t.k,t.v),r=t.r}}function Zr(r){var e=r.l;r.l=e.r,e.r=r;var t=U(r.l),n=U(r.r);r.h=(t>n?t:n)+1|0;var u=U(e.l),a=r.h;return e.h=(u>a?u:a)+1|0,e}function Yr(r){var e=r.r;r.r=e.l,e.l=r;var t=U(r.l),n=U(r.r);r.h=(t>n?t:n)+1|0;var u=U(e.r),a=r.h;return e.h=(u>a?u:a)+1|0,e}function on(r){var e=r.l,t=Yr(e);return r.l=t,Zr(r)}function ln(r){var e=r.r,t=Zr(e);return r.r=t,Yr(r)}function Cr(r){var e=U(r.l),t=U(r.r);return r.h=(e>t?e:t)+1|0,r}function W(r){var e=r.l,t=r.r,n=U(e),u=U(t);if(n>(2+u|0)){var a=e.l,i=e.r;return rt(a,i)?Cr(Zr(r)):Cr(on(r))}if(u>(2+n|0)){var o=t.l,f=t.r;return rt(f,o)?Cr(Yr(r)):Cr(ln(r))}return r.h=(n>u?n:u)+1|0,r}function Vr(r,e){var t=e.r,n=e.l;return n!==void 0?(e.l=Vr(r,n),W(e)):(r.k=e.k,r.v=e.v,t)}function qr(r,e){for(;;){var t=r;if(t===void 0)return;var n=t.k;if(e===n)return w(t.v);r=e<n?t.l:t.r}}function re(r,e){for(;;){var t=r;if(t===void 0)return!1;var n=t.k;if(e===n)return!0;r=e<n?t.l:t.r}}function Ur(r,e,t){if(r===void 0)return nr(e,t);var n=r.k;if(e===n)return r.k=e,r.v=t,r;var u=r.l,a=r.r;if(e<n){var i=Ur(u,e,t);r.l=i}else r.r=Ur(a,e,t);return W(r)}function dr(r){return{data:void 0}}function tt(r){return Hr(r.data)}function ee(r,e,t){var n=r.data,u=Ur(n,e,t);if(u!==n){r.data=u;return}}function te(r,e){var t=r.k;if(e===t){var n=r.l,u=r.r;return n!==void 0?u!==void 0?(r.r=Vr(r,u),W(r)):n:u}if(e<t){var a=r.l;return a!==void 0?(r.l=te(a,e),W(r)):r}var i=r.r;return i!==void 0?(r.r=te(i,e),W(r)):r}function ne(r,e){var t=r.data;if(t!==void 0){var n=te(t,e);if(n!==t){r.data=n;return}}}function ue(r,e,t){if(r!==void 0){var n=r.k;if(n===e){var u=t(w(r.v));if(u!==void 0)return r.v=T(u),r;var a=r.l,i=r.r;return a!==void 0?i!==void 0?(r.r=Vr(r,i),W(r)):a:i}var o=r.l,f=r.r;if(e<n){var l=ue(o,e,t);r.l=l}else r.r=ue(f,e,t);return W(r)}var c=t(void 0);return c!==void 0?nr(e,T(c)):r}function nt(r,e,t){var n=r.data,u=ue(n,e,t);if(u!==n){r.data=u;return}}function ae(r,e){return qr(r.data,e)}function P(r,e){switch(r.TAG|0){case 2:return{NAME:"String",VAL:[r._0,r._1]};case 3:return{NAME:"Number",VAL:[r._0,r._1]};case 4:return{NAME:"True",VAL:r._0};case 5:return{NAME:"False",VAL:r._0};case 6:return{NAME:"Null",VAL:r._0};case 9:var t=r._0,n=s(e);if(n.TAG===10)return{NAME:"Array",VAL:[t,[]]};var u=E(void 0);v(u,P(n,e));for(var a;;){var i=s(e);switch(i.TAG|0){case 7:var o=s(e);if(o.TAG===13){var f=s(e);if(f.TAG===18){var l=s(e);if(l.TAG===10)return{NAME:"ArrayWithTailBinding",VAL:[t,p(u),{NAME:"Binding",VAL:[f._0,f._1]}]};throw{RE_EXN_ID:A,_1:L(l,y(e)),Error:new Error}}throw{RE_EXN_ID:A,_1:L(f,y(e)),Error:new Error}}v(u,P(o,e)),a=void 0;continue;case 10:return{NAME:"Array",VAL:[t,p(u)]};default:throw{RE_EXN_ID:A,_1:L(i,y(e)),Error:new Error}}}case 11:var c=r._0,d=s(e);if(d.TAG===12)return{NAME:"Object",VAL:[c,[]]};var _=E(void 0);v(_,ut(d,e));for(var g;;){var m=s(e);switch(m.TAG|0){case 7:v(_,ut(s(e),e)),g=void 0;continue;case 12:return{NAME:"Object",VAL:[c,p(_)]};default:throw{RE_EXN_ID:A,_1:L(m,y(e)),Error:new Error}}}case 18:return{NAME:"Binding",VAL:[r._0,r._1]};default:throw{RE_EXN_ID:A,_1:L(r,y(e)),Error:new Error}}}function ut(r,e){switch(r.TAG|0){case 2:var t=s(e);if(t.TAG===8)return[r._1,P(s(e),e)];throw{RE_EXN_ID:A,_1:L(t,y(e)),Error:new Error};case 18:var n=r._1,u=Br(e);return u.TAG!==8?[n,{NAME:"Binding",VAL:[r._0,n]}]:(s(e),[n,P(s(e),e)]);default:throw{RE_EXN_ID:A,_1:L(r,y(e)),Error:new Error}}}function oe(r){for(var e=P(s(r),r),t=E(void 0),n;;){var u=Br(r);if(u.TAG!==7)return{_0:e,_1:p(t)};s(r),v(t,P(s(r),r)),n=void 0}}function at(r){var e=s(r);if(e.TAG===18)return[e._0,e._1];throw{RE_EXN_ID:A,_1:L(e,y(r)),Error:new Error}}function kn(r){for(var e=at(r),t=E(void 0),n;;){var u=Br(r);if(u.TAG!==7)return{_0:e,_1:p(t)};s(r),v(t,at(r)),n=void 0}}function it(r,e,t){switch(r.TAG|0){case 2:return{TAG:2,_0:r._1,_1:t};case 3:return{TAG:3,_0:r._1,_1:t};case 18:return{TAG:0,_0:r._0,_1:r._1,_2:t};default:throw{RE_EXN_ID:A,_1:L(r,y(e)),Error:new Error}}}function ot(r){var e=s(r);switch(e.TAG|0){case 14:return{TAG:1,_0:e._0,_1:e._1};case 21:return it(s(r),r,0);default:return it(e,r,1)}}function Dn(r){for(var e=ot(r),t=E(void 0),n;;){var u=s(r);switch(u.TAG|0){case 0:case 19:return{nextToken:u,data:{_0:e,_1:p(t)}};case 20:v(t,ot(r)),n=void 0;continue;default:throw{RE_EXN_ID:A,_1:L(u,y(r)),Error:new Error}}}}function Sn(r){switch(r.TAG|0){case 15:return!0;case 18:return r._1==="with";default:return!1}}function Rn(r){return r.TAG===23}function lt(r){return r.TAG===15}function xr(r,e,t,n,u){for(var a=E(void 0),i=r;;){var o=i;if(t(o))return{nextToken:o,data:p(a)};switch(o.TAG|0){case 0:var f=o._1,l=s(e);if(l.TAG===19){v(a,{TAG:0,_0:f,_1:1}),i=s(e);continue}v(a,{TAG:0,_0:f,_1:3}),i=l;continue;case 1:i=s(e);continue;case 14:v(a,Qn(o._0,o._1,e,n,u)),i=s(e);continue;case 18:var c=o._0;switch(o._1){case"map":var d=P(s(e),e),_=d.NAME;if(_==="Array"||_==="ArrayWithTailBinding"||_==="Binding"||_==="Object"){var g=ft(e,"map",n,u);v(a,{TAG:3,_0:c,_1:d,_2:g}),i=s(e);continue}throw{RE_EXN_ID:A,_1:ke(d,y(e)),Error:new Error};case"match":var m=kn(e),b=ft(e,"match",n,u);v(a,{TAG:2,_0:c,_1:m,_2:b}),i=s(e);continue;default:throw{RE_EXN_ID:A,_1:L(o,y(e)),Error:new Error}}case 19:var B=s(e);if(B.TAG===0){var x=B._1,N=s(e);if(N.TAG===19){v(a,{TAG:0,_0:x,_1:2}),i=s(e);continue}v(a,{TAG:0,_0:x,_1:0}),i=N;continue}throw{RE_EXN_ID:A,_1:L(B,y(e)),Error:new Error};case 22:var Q=Dn(e);v(a,{TAG:1,_0:o._0,_1:Q.data}),i=Q.nextToken;continue;default:throw{RE_EXN_ID:A,_1:L(o,y(e)),Error:new Error}}}}function ct(r,e,t){for(var n=oe(r),u=E(void 0),a;;){var i=s(r);if(i.TAG===18&&i._1==="with"){v(u,oe(r)),a=void 0;continue}var o=xr(i,r,Sn,e,t);return{nextToken:o.nextToken,data:{patterns:{_0:n,_1:p(u)},ast:o.data}}}}function ft(r,e,t,n){var u=s(r);if(u.TAG===18){if(u._1==="with")for(var a=ct(r,t,n),i=a.data,o=E(void 0),f=a.nextToken;;){var l=f;if(l.TAG===15){var c=s(r);if(c.TAG===18){if(c._1===e)return{_0:i,_1:p(o)};throw{RE_EXN_ID:A,_1:L(c,y(r)),Error:new Error}}throw{RE_EXN_ID:A,_1:L(c,y(r)),Error:new Error}}var d=ct(r,t,n);v(o,d.data),f=d.nextToken}throw{RE_EXN_ID:A,_1:L(u,y(r)),Error:new Error}}throw{RE_EXN_ID:A,_1:L(u,y(r)),Error:new Error}}function Qn(r,e,t,n,u){var a=In(t,n,u),i=a.data,o=i[1],f=i[0],l=a.nextToken;if(l.TAG===15)return{TAG:4,loc:r,name:e,props:p(f),children:p(o),f:u(n,e,r)};var c=xr(l,t,lt,n,u),d=s(t);if(d.TAG===14){if(e===d._1)return v(o,["Children",{TAG:1,_0:c.data}]),{TAG:4,loc:r,name:e,props:p(f),children:p(o),f:u(n,e,r)};throw{RE_EXN_ID:A,_1:L(d,y(t)),Error:new Error}}throw{RE_EXN_ID:A,_1:L(d,y(t)),Error:new Error}}function In(r,e,t){for(var n=E(void 0),u=E(void 0),a=s(r);;){var i=a;switch(i.TAG|0){case 14:var o=i._1,f=s(r);if(f.TAG===17){var l=s(r);switch(l.TAG|0){case 14:v(u,[o,{TAG:0,_0:l._1}]),a=s(r);continue;case 16:var c=xr(s(r),r,lt,e,t),d=s(r);if(d.TAG===16){v(u,[o,{TAG:1,_0:c.data}]),a=s(r);continue}throw{RE_EXN_ID:A,_1:L(d,y(r)),Error:new Error};default:throw{RE_EXN_ID:A,_1:L(l,y(r)),Error:new Error}}}else{v(u,[o,{TAG:0,_0:o}]),a=f;continue}case 18:var _=i._1,g=s(r);if(g.TAG===17){var m=P(s(r),r);v(n,[_,m]),a=s(r);continue}v(n,[_,{NAME:"Binding",VAL:[i._0,_]}]),a=g;continue;default:return{nextToken:i,data:[n,u]}}}}function le(r,e,t,n){var u=qe(r,n),a=xr(s(u),u,Rn,e,t);return{ast:a.data,name:r}}function vt(r,e,t){switch(r.TAG|0){case 0:var n=le(r.name,e,t,r.src);return function(u,a,i){return u.render(n,a,i)};case 1:return r.f;case 2:return fr(r.f,le(r.name,e,t,r.src))}}function st(r,e,t){try{return{NAME:"ok",VAL:vt(r,e,t)}}catch(u){var n=Mr(u);return n.RE_EXN_ID===A?{NAME:"errors",VAL:[n._1]}:{NAME:"errors",VAL:[Ie(n,er(r))]}}}function Gn(r,e){return r===e}function fe(r,e,t){var n=ae(r.compiled,e);if(n!==void 0)return n;var u=ae(r.srcQueue,e);if(u!==void 0){ne(r.srcQueue,e);var a=vt(u,{compiled:r.compiled,srcQueue:r.srcQueue,stack:{hd:e,tl:r.stack}},fe),i=$(a);return ee(r.compiled,e,i),i}throw we(r.stack,e,Gn)?{RE_EXN_ID:A,_1:Se(t,e,r.stack),Error:new Error}:{RE_EXN_ID:A,_1:Re(t,e,r.stack),Error:new Error}}function jn(r){return dr(void 0)}function On(r){var e=E(void 0),t=dr(void 0),n=dr(void 0);F(r,function(d){return nt(n,er(d),function(_){return _!==void 0?(v(e,Qe(er(d))),_):d})});for(var u;;){var a=tt(n);if(a===void 0)return z(e)?{NAME:"ok",VAL:t}:{NAME:"errors",VAL:p(e)};var i=a[0];ne(n,i);var o={hd:i,tl:0},f={compiled:t,srcQueue:n,stack:o},l=st(a[1],f,fe);if(l.NAME==="ok"){var c=l.VAL;ee(t,i,$(c))}else O(X(l.VAL),e);u=void 0}}function Wn(r,e){return st(r,{compiled:e,srcQueue:dr(void 0),stack:{hd:er(r),tl:0}},fe)}var $n={make:oe},Fn={empty:jn,make:On};var de={};hr(de,{async:()=>lu,sync:()=>eu});function Y(r,e){if(e in r)return w(r[e])}function _r(r){var e=typeof r;return e==="string"?{TAG:0,_0:r}:e==="number"?{TAG:1,_0:r}:e==="boolean"?r===!0?1:0:r===null?2:Array.isArray(r)?{TAG:3,_0:r}:{TAG:2,_0:r}}function Nr(r,e,t){if(r===void 0)return nr(e,t);var n=r.k;if(e===n)return Xr(r,t);var u=r.v;return e<n?wr(Nr(r.l,e,t),n,u,r.r):wr(r.l,n,u,Nr(r.r,e,t))}var dt=re;var _t=Tr;function kr(r,e){for(var t=E(void 0),n=0;;){var u=n,a=S(r,u);if(a===void 0)return{NAME:"ok",VAL:t};var i=e(T(a));if(i.NAME!=="ok")return i;v(t,i.VAL),n=u+1|0}}function Ar(r,e,t){var n=r.NAME;if(n==="Object")return D(kr(r.VAL[1],function(o){var f=o[0];return D(Ar(o[1],e,t),function(l){return[f,l]})}),function(o){var f={};return sr(o,function(l){f[l[0]]=l[1]}),f});if(n!=="Binding")return n==="False"?{NAME:"ok",VAL:!1}:n==="Array"||n==="ArrayWithTailBinding"?D(At(r,e,t),function(o){return o}):n==="Null"?{NAME:"ok",VAL:null}:n==="True"?{NAME:"ok",VAL:!0}:{NAME:"ok",VAL:r.VAL[1]};var u=r.VAL,a=u[1],i=Y(e,a);return i!==void 0?{NAME:"ok",VAL:T(i)}:{NAME:"errors",VAL:[$r(u[0],a,t)]}}function At(r,e,t){if(r.NAME==="Array")return D(kr(r.VAL[1],function(l){return Ar(l,e,t)}),p);var n=r.VAL,u=n[2].VAL,a=u[1],i=Y(e,a);if(i===void 0)return{NAME:"errors",VAL:[$r(u[0],a,t)]};var o=_r(T(i));if(typeof o!="number"&&o.TAG===3){var f=o._0;return D(kr(n[1],function(l){return Ar(l,e,t)}),function(l){return Be(p(l),f)})}return{NAME:"errors",VAL:[je(o,r,a,t)]}}function mt(r,e,t,n){var u=e.VAL,a=u[1];return a==="_"?{NAME:"ok",VAL:r}:dt(r,a)?{NAME:"errors",VAL:[Oe(u[0],a,n)]}:{NAME:"ok",VAL:Nr(r,a,t)}}function ce(r,e,t,n){var u=_r(e),a=r.NAME;if(a==="Object"){var i=r.VAL[1];if(i.length!==0){if(typeof u=="number"){if(u===2)return 0}else if(u.TAG===2)for(var o=u._0,f=t,l=0;;){var c=l,d=f,_=S(i,c);if(_===void 0)return{_0:{NAME:"ok",VAL:d}};var g=Y(o,_[0]);if(g===void 0)return 0;var m=ce(_[1],T(g),d,n);if(!m)return m;var b=m._0;if(b.NAME!=="ok")return m;l=c+1|0,f=b.VAL}}else if(typeof u=="number"){if(u===2)return 0}else if(u.TAG===2)return Object.keys(u._0).length===0?{_0:{NAME:"ok",VAL:t}}:0}else{if(a==="Binding")return{_0:mt(t,r,e,n)};if(a==="Number"){if(typeof u=="number"){if(u===2)return 0}else if(u.TAG===1)return r.VAL[1]===u._0?{_0:{NAME:"ok",VAL:t}}:0}else if(a==="False"){if(typeof u=="number")switch(u){case 0:return{_0:{NAME:"ok",VAL:t}};case 1:case 2:return 0}}else if(a==="ArrayWithTailBinding"){var B=r.VAL,x=B[1];if(typeof u=="number"){if(u===2)return 0}else if(u.TAG===3){var N=u._0,Q=ht(x,N,t,n);if(!Q)return Q;var J=Q._0;return J.NAME==="ok"?{_0:mt(J.VAL,B[2],Me(N,x.length),n)}:Q}}else{if(a==="Null")return typeof u=="number"&&u>=2?{_0:{NAME:"ok",VAL:t}}:0;if(a==="True"){if(typeof u=="number")switch(u){case 1:return{_0:{NAME:"ok",VAL:t}};case 0:case 2:return 0}}else if(a==="Array"){var q=r.VAL[1];if(q.length!==0){if(typeof u=="number"){if(u===2)return 0}else if(u.TAG===3)return ht(q,u._0,t,n)}else if(typeof u=="number"){if(u===2)return 0}else if(u.TAG===3)return u._0.length!==0?0:{_0:{NAME:"ok",VAL:t}}}else if(typeof u=="number"){if(u===2)return 0}else if(u.TAG===0)return r.VAL[1]===u._0?{_0:{NAME:"ok",VAL:t}}:0}}return{_0:{NAME:"errors",VAL:[Ge(u,r,n)]}}}function ht(r,e,t,n){for(var u=t,a=0;;){var i=a,o=u,f=S(r,i);if(f===void 0)return{_0:{NAME:"ok",VAL:o}};var l=S(e,i);if(l===void 0)return 0;var c=ce(f,T(l),o,n);if(!c)return c;var d=c._0;if(d.NAME!=="ok")return c;a=i+1|0,u=d.VAL}}function Pn(r,e,t,n){for(var u=e._1,a=r._1,i=r._0,o=e._0,f,l=0;;){var c=l,d=f,_=o,g=i,m=ce(g,_,d,n);if(!m)return m;var b=m._0;if(b.NAME!=="ok")return m;var B=b.VAL,x=S(a,c),N=S(u,c);if(x!==void 0){if(N!==void 0){l=c+1|0,f=B,o=T(N),i=x;continue}}else if(N===void 0)return{_0:{NAME:"ok",VAL:B}};return{_0:{NAME:"errors",VAL:[$e(t,n)]}}}}function Jn(r,e,t,n){for(var u=r.f,a=r.patterns,i=a._1,o=a._0,f=0;;){var l=f,c=o,d=Pn(c,e,t,n);if(d){var _=d._0;if(_.NAME!=="ok")return d;var g={};return _t(_.VAL,function(b){return function(B,x){b[B]=x}}(g)),{_0:{NAME:"ok",VAL:u(g)}}}var m=S(i,l);if(m===void 0)return 0;f=l+1|0,o=m}}function pt(r,e,t,n){for(var u=r._1,a=r._0,i=0;;){var o=i,f=a,l=Jn(f,e,t,n);if(l)return l._0;var c=S(u,o);if(c===void 0)return{NAME:"errors",VAL:[We(t,n)]};i=o+1|0,a=c}}function Kn(r){switch(r){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&apos;";case"/":return"&#x2F;";case"<":return"&lt;";case"=":return"&#x3D;";case">":return"&gt;";case"`":return"&#x60;";default:return r}}function ve(r,e){if(r)for(var t=0,n="";;){var u=n,a=t,i=e.charAt(a);if(i==="")return u;n=u+Kn(i),t=a+1|0}else return e}function se(r,e){var t=Y(r,e);return t!==void 0?T(t):null}function zn(r,e){var t=_r(se(r,e));if(typeof t=="number")return{TAG:1,_0:t};switch(t.TAG|0){case 0:return{TAG:0,_0:t._0};case 1:return{TAG:0,_0:String(t._0)};default:return{TAG:1,_0:t}}}function gt(r){for(var e=0;;){var t=e,n=r.charAt(t);switch(n){case"	":case`
`:case"\r":case" ":e=t+1|0;continue;default:return r.slice(t)}}}function yt(r){for(var e=r.length;;){var t=e,n=r.charAt(t-1|0);switch(n){case"	":case`
`:case"\r":case" ":e=t-1|0;continue;default:return r.slice(0,t)}}}function Xn(r,e,t,n,u,a,i){for(var o=r,f=0;;){var l=f,c=o;switch(c.TAG|0){case 0:var d=c._1,_=zn(t,d);if(_.TAG===0)return a.return(ve(c._2,_._0));var g=_._0,m=S(e,l);if(typeof g=="number"&&g>=2&&m!==void 0){f=l+1|0,o=m;continue}return i([Fe(c._0,d,g,n)]);case 1:var b=c._1,B=Y(u,b);if(B!==void 0)return T(B);var x=S(e,l);if(x===void 0)return i([Fr(c._0,b,n)]);f=l+1|0,o=x;continue;case 2:return a.return(ve(c._1,c._0));case 3:return a.return(ve(c._1,String(c._0)))}}}function ur(r,e,t,n,u,a,i,o){var f=u(n),l=E(void 0);return F(r,function(c){switch(c.TAG|0){case 0:var d=c._0,_;switch(c._1){case 0:_=gt(d);break;case 1:_=yt(d);break;case 2:_=gt(yt(d));break;case 3:_=d;break}return v(l,f.return(_));case 1:var g=c._1;return v(l,Xn(g._0,g._1,e,n,t,f,a));case 2:var m=vr.map(c._2,function(h){var C=h.ast;return{patterns:h.patterns,f:function(j){return ur(C,Object.assign({},e,j),t,{hd:0,tl:n},u,a,i,o)}}}),b=vr.map(c._1,function(h){return se(e,h[1])}),B=pt(m,b,c._0,n);return B.NAME==="ok"?O(B.VAL,l):v(l,a(B.VAL));case 3:var x=c._2,N=c._1,Q=c._0,J=function(h,C){var j=vr.map(x,function(ir){var xt=ir.ast;return{patterns:vr.map(ir.patterns,function(or){return or._1.length!==0?or:{_0:or._0,_1:[{NAME:"Binding",VAL:[Q,"_"]}]}}),f:function(or){return ur(xt,Object.assign({},e,or),t,{hd:{TAG:2,_0:h},tl:{hd:1,tl:n}},u,a,i,o)}}}),rr=pt(j,{_0:C,_1:[h]},Q,n);return rr.NAME==="ok"?O(rr.VAL,l):v(l,a(rr.VAL))},q=N.NAME;if(q!=="Binding")return q==="Array"||q==="ArrayWithTailBinding"?cr(D(At(N,e,n),function(h){return jr(h,J)}),function(h){return v(l,a(h))}):cr(D(kr(N.VAL[1],function(h){var C=h[0];return D(Ar(h[1],e,n),function(j){return[C,j]})}),function(h){return sr(h,function(C){return J(C[0],C[1])})}),function(h){return v(l,a(h))});var me=N.VAL,he=me[1],ar=_r(se(e,he));if(typeof ar!="number")switch(ar.TAG|0){case 2:for(var pe=ar._0,ge=Object.keys(pe),Tt=ge.length,Dr=0;Dr<Tt;++Dr){var ye=ge[Dr];J(ye,pe[ye])}return;case 3:return jr(ar._0,J);default:}return v(l,a([Pe(me[0],he,ar,n)]));case 4:var Ct=c.f,Vt=c.name,Ut=c.loc,Le={},Sr={},mr=E(void 0);return F(c.children,function(h){var C=h[1],j=h[0];if(C.TAG===0){var rr=C._0,ir=Y(t,rr);if(ir!==void 0){Sr[j]=T(ir);return}else return v(mr,Fr(Ut,rr,n))}Sr[j]=o(ur(C._0,e,t,{hd:{TAG:1,component:Vt,section:j},tl:n},u,a,i,o))}),F(c.props,function(h){var C=Ar(h[1],e,n);if(C.NAME==="ok"){Le[h[0]]=C.VAL;return}else return O(X(C.VAL),mr)}),z(mr)?v(l,i(function(){return Ct(f,Le,Sr)},function(h){return a([Je(h,n)])})):v(l,a(p(mr)))}}),l}function Hn(r){return{NAME:"ok",VAL:r}}function Zn(r){return{NAME:"errors",VAL:r}}function Yn(r,e){try{return r()}catch(n){var t=Mr(n);return e(t)}}var qn=pr,ru=Ir;function Lt(r){var e={contents:""},t=E(void 0);return sr(r,function(n){if(n.NAME==="ok"){e.contents=e.contents+n.VAL;return}else return O(X(n.VAL),t)}),z(t)?{NAME:"ok",VAL:e.contents}:{NAME:"errors",VAL:p(t)}}function Et(r){return{render:function(e,t,n){return Lt(ur(e.ast,t,n,{hd:{TAG:0,_0:e.name},tl:r},Et,Zn,Yn,Lt))},return:Hn,error:function(e){return{NAME:"errors",VAL:[Pr(e,r)]}},mapChild:qn,flatMapChild:ru}}var eu=Et(0);function tu(r){return Promise.resolve({NAME:"ok",VAL:r})}function nu(r){return Promise.resolve({NAME:"errors",VAL:r})}function uu(r,e){return r().catch(function(t){return e(t)})}function au(r,e){return r.then(function(t){return Promise.resolve(pr(t,e))})}function iu(r,e){return r.then(function(t){return t.NAME==="ok"?fr(e,t.VAL):Promise.resolve(t)})}function ou(r){var e={contents:""},t=E(void 0);return F(r,function(n){if(n.NAME==="ok"){e.contents=e.contents+n.VAL;return}else return O(X(n.VAL),t)}),z(t)?Promise.resolve({NAME:"ok",VAL:e.contents}):Promise.resolve({NAME:"errors",VAL:p(t)})}function bt(r){return Promise.all(p(r)).then(ou)}function Bt(r){return{render:function(e,t,n){return bt(ur(e.ast,t,n,{hd:{TAG:0,_0:e.name},tl:r},Bt,nu,uu,bt))},return:tu,error:function(e){return Promise.resolve({NAME:"errors",VAL:[Pr(e,r)]})},mapChild:au,flatMapChild:iu}}var lu=Bt(0);var _e=ie,Mt=de,Ae=Qr,wt=Gr;window.onload=function(e){var t=document.getElementById("props"),n=document.getElementById("source"),u=document.getElementById("source-is-dirty"),a=document.getElementById("props-is-dirty");function i(c){c.textContent="*"}function o(c){c.textContent=""}t.oninput=function(c){i(a)},n.oninput=function(c){i(u)},t.value=JSON.stringify({name:null,objects:[{name:"sky",color:"blue"},{name:"grass",color:"purple"},{name:"air"}]},null,2),n.value=`Hello {{ name ? "dear user" }},

{% map objects with {name, color} ~%}
  Have you noticed the {{ name }} is {{ color }} today?
{% match name, color
   with "sky", "blue"
   with "grass", "green" ~%}
  That's an ordinary color for it.
{% with _, _ ~%}
  That seems odd.
{% /match %}
{% with {name} ~%}
  The {{ name }}, I suppose, has no color.
{%~ /map %}
`;var f=document.getElementById("result");function l(c){try{var d=JSON.parse(t.value),_=wt.string("Playground",n.value),g=_e.make(_,_e.Components.empty()),m=Ae.flatMap(g,b=>b(Mt.sync,d,{}));f.value=Ae.getOrElse(m,b=>`Errors:
`+JSON.stringify(b,null,2))}catch(b){f.value=b.message}o(a),o(u)}document.getElementById("render").onclick=l,l()};
//# sourceMappingURL=playground.js.map

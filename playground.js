var pn=Object.defineProperty;var vr=(r,e)=>{for(var n in e)pn(r,n,{get:e[n],enumerable:!0})};var xr={};vr(xr,{flatMap:()=>Ur,flatMapU:()=>le,getExn:()=>gn,getOrElse:()=>yn,getOrElseU:()=>oe,map:()=>I,mapU:()=>fe});function Cr(r,e,n){for(var t=new Array(n),u=0,a=e;u<n;)t[u]=r[a],u=u+1|0,a=a+1|0;return t}function ur(r,e){for(;;){var n=e,t=r,u=t.length,a=u===0?1:u,i=n.length,f=a-i|0;if(f===0)return t.apply(null,n);if(f>=0)return function(l,c){return function(s){return ur(l,c.concat([s]))}}(t,n);e=Cr(n,a,-f|0),r=t.apply(null,Cr(n,0,a))}}function Gr(r,e){var n=r.length;if(n===1)return r(e);switch(n){case 1:return r(e);case 2:return function(t){return r(e,t)};case 3:return function(t,u){return r(e,t,u)};case 4:return function(t,u,a){return r(e,t,u,a)};case 5:return function(t,u,a,i){return r(e,t,u,a,i)};case 6:return function(t,u,a,i,f){return r(e,t,u,a,i,f)};case 7:return function(t,u,a,i,f,l){return r(e,t,u,a,i,f,l)};default:return ur(r,[e])}}function V(r){var e=r.length;return e===1?r:function(n){return Gr(r,n)}}function hn(r,e,n,t){var u=r.length;if(u===3)return r(e,n,t);switch(u){case 1:return ur(r(e),[n,t]);case 2:return ur(r(e,n),[t]);case 3:return r(e,n,t);case 4:return function(a){return r(e,n,t,a)};case 5:return function(a,i){return r(e,n,t,a,i)};case 6:return function(a,i,f){return r(e,n,t,a,i,f)};case 7:return function(a,i,f,l){return r(e,n,t,a,i,f,l)};default:return ur(r,[e,n,t])}}function K(r){var e=r.length;return e===3?r:function(n,t,u){return hn(r,n,t,u)}}function fe(r,e){return r.NAME==="ok"?{NAME:"ok",VAL:e(r.VAL)}:r}function I(r,e){return fe(r,V(e))}function le(r,e){return r.NAME==="ok"?e(r.VAL):r}function Ur(r,e){return le(r,V(e))}function gn(r){if(r.NAME==="ok")return r.VAL;throw{RE_EXN_ID:"Not_found",Error:new Error}}function oe(r,e){return r.NAME==="ok"?r.VAL:e(r.VAL)}function yn(r,e){return oe(r,V(e))}var Vr={};vr(Vr,{func:()=>En,funcWithString:()=>Tn,name:()=>Nr,string:()=>Ln});function Ln(r,e){return{TAG:0,name:r,src:e}}function En(r,e){return{TAG:1,name:r,f:e}}function Tn(r,e,n){return{TAG:2,name:r,src:e,f:n}}function Nr(r){return r.name}var Jr={};vr(Jr,{Pattern:()=>nt,emptyMap:()=>tt,fromArray:()=>et,make:()=>Ye,makeAst:()=>Kr});function w(r){return r===void 0?{BS_PRIVATE_NESTED_SOME_NONE:0}:r!==null&&r.BS_PRIVATE_NESTED_SOME_NONE!==void 0?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function M(r){if(!(r!==null&&r.BS_PRIVATE_NESTED_SOME_NONE!==void 0))return r;var e=r.BS_PRIVATE_NESTED_SOME_NONE;if(e!==0)return{BS_PRIVATE_NESTED_SOME_NONE:e-1|0}}function ce(r,e){return r>e?r:e}function U(r,e){if(e>=0&&e<r.length)return w(r[e])}function ve(r,e){for(var n=r.length,t=e.length,u=new Array(n+t|0),a=0;a<n;++a)u[a]=r[a];for(var i=0;i<t;++i)u[n+i|0]=e[i];return u}function se(r,e){for(var n=r.length,t=e<0?ce(n+e|0,0):e,u=n-t|0,a=new Array(u),i=0;i<u;++i)a[i]=r[t+i|0];return a}function Z(r,e){for(var n=0,t=r.length;n<t;++n)e(r[n])}function sr(r,e){for(var n=r.length,t=new Array(n),u=0;u<n;++u)t[u]=e(r[u]);return t}function _e(r,e){for(var n=0,t=r.length;n<t;++n)e(n,r[n])}function de(r,e,n){for(var t=e,u=0,a=r.length;u<a;++u)t=n(t,r[u]);return t}function X(r){return r!==void 0?r.h:0}function N(r,e,n,t){var u=X(r),a=X(t);return{k:e,v:n,h:u>=a?u+1|0:a+1|0,l:r,r:t}}function kr(r,e){return{k:r,v:e,h:1,l:void 0,r:void 0}}function Sr(r,e){return r.v===e?r:{k:r.k,v:e,h:r.h,l:r.l,r:r.r}}function _r(r,e,n,t){var u=r!==void 0?r.h:0,a=t!==void 0?t.h:0;if(u>(a+2|0)){var i=r.l,f=r.r;return X(i)>=X(f)?N(i,r.k,r.v,N(f,e,n,t)):N(N(i,r.k,r.v,f.l),f.k,f.v,N(f.r,e,n,t))}if(a<=(u+2|0))return{k:e,v:n,h:u>=a?u+1|0:a+1|0,l:r,r:t};var l=t.l,c=t.r;return X(c)>=X(l)?N(N(r,e,n,l),t.k,t.v,c):N(N(r,e,n,l.l),l.k,l.v,N(l.r,t.k,t.v,c))}function Qr(r,e){for(;;){var n=r;if(n===void 0)return;Qr(n.l,e),e(n.k,n.v),r=n.r}}function dr(r,e){if(r!==void 0){var n=dr(r.l,e),t=e(r.v),u=dr(r.r,e);return{k:r.k,v:t,h:r.h,l:n,r:u}}}function Ae(r,e){for(;;){var n=r;if(n===void 0)return;var t=n.k;if(e===t)return w(n.v);r=e<t?n.l:n.r}}function me(r,e){for(;;){var n=r;if(n===void 0)return!1;var t=n.k;if(e===t)return!0;r=e<t?n.l:n.r}}function Y(r,e,n){if(r===void 0)return kr(e,n);var t=r.k;if(e===t)return Sr(r,n);var u=r.v;return e<t?_r(Y(r.l,e,n),t,u,r.r):_r(r.l,t,u,Y(r.r,e,n))}var Ar=me;var pe=Qr;var he=Ae;var ge=dr;function Mn(r){for(var e=r,n=0;;){var t=n,u=e;if(!u)return t;n=t+1|0,e=u.tl}}function Cn(r,e,n){for(;;){var t=n,u=e;if(!t)return;r[u]=t.hd,n=t.tl,e=u+1|0}}function ye(r){var e=Mn(r),n=new Array(e);return Cn(n,0,r),n}var Dr={contents:0};function mr(r){return Dr.contents=Dr.contents+1|0,r+("/"+Dr.contents)}function Le(r){return r==null?!1:typeof r.RE_EXN_ID=="string"}function Gn(r,e){return{_0:e(r._0),_1:sr(r._1,e)}}var ar={map:Gn};function xn(r){return{character:r+1|0}}function Un(r){if(typeof r=="number")return r===0?"match":"map";switch(r.TAG|0){case 1:return"section: "+r.component+"#"+r.section;case 0:case 2:return r._0}}var Vn={nameToJson:Un},y={$$location:xn,Stack:Vn};function Nn(r){switch(r.TAG|0){case 0:return"[text]: "+r._1;case 1:return"{*"+r._1+"*}";case 2:return'"'+r._1+'"';case 3:return String(r._1);case 4:return"true";case 5:return"false";case 6:return"null";case 7:return",";case 8:return":";case 9:return"[";case 10:return"]";case 11:return"{";case 12:return"}";case 13:return"...";case 15:return"/";case 16:return"#";case 17:return"=";case 14:case 18:return r._1;case 19:return"~";case 20:return"?";case 21:return"&";case 22:return"{{";case 23:return"[end of file]"}}function kn(r){return r._0}var Rr={toString:Nn,toLocation:kn};function Sn(r){var e=r.NAME;return e==="Object"?"object":e==="Binding"?"binding: `"+r.VAL[1]+"`":e==="Number"?"number":e==="True"||e==="False"?"boolean":e==="Array"||e==="ArrayWithTailBinding"?"array":e==="Null"?"null":"string"}function Qn(r){var e=r.NAME;return e==="True"||e==="Null"||e==="False"?r.VAL:r.VAL[0]}var j={toString:Sn,toLocation:Qn};function C(r){return sr(ye(r),y.Stack.nameToJson)}var k=mr("Debug-AcutisLang.CompileError");function Ee(r,e){throw{RE_EXN_ID:k,_1:{message:"Unexpected end of file.",kind:"Syntax",location:y.$$location(r),path:[e],exn:void 0},Error:new Error}}function Te(r,e){throw{RE_EXN_ID:k,_1:{message:"Unterminated comment.",kind:"Syntax",location:y.$$location(r),path:[e],exn:void 0},Error:new Error}}function be(r,e){throw{RE_EXN_ID:k,_1:{message:"Unterminated string.",kind:"Syntax",location:y.$$location(r),path:[e],exn:void 0},Error:new Error}}function Be(r,e,n){throw{RE_EXN_ID:k,_1:{message:'"'+n+'" is an illegal identifier name.',kind:"Parse",location:y.$$location(r),path:[e],exn:void 0},Error:new Error}}function we(r,e,n){throw{RE_EXN_ID:k,_1:{message:'Invalid character: "'+n+'".',kind:"Syntax",location:y.$$location(r),path:[e],exn:void 0},Error:new Error}}function pr(r,e,n,t){throw{RE_EXN_ID:k,_1:{message:'Unexpected character: "'+n+'". Expected: "'+t+'".',kind:"Syntax",location:y.$$location(r),path:[e],exn:void 0},Error:new Error}}function L(r,e){throw{RE_EXN_ID:k,_1:{message:'Unexpected token: "'+Rr.toString(r)+'".',kind:"Parse",location:y.$$location(Rr.toLocation(r)),path:[e],exn:void 0},Error:new Error}}function Me(r,e){throw{RE_EXN_ID:k,_1:{message:'Bad map type: "'+j.toString(r)+'". I can only map bindings and arrays.',kind:"Parse",location:y.$$location(j.toLocation(r)),path:[e],exn:void 0},Error:new Error}}function hr(r){if(typeof r=="number")switch(r){case 0:case 1:return"boolean";case 2:return"null"}else switch(r.TAG|0){case 0:return"string";case 1:return"number";case 2:return"object";case 3:return"array"}}function Ce(r,e,n){return{message:'Component "'+e+'" does not exist.',kind:"Render",location:y.$$location(r),path:C(n),exn:void 0}}function Ge(r,e,n){var t=hr(r),u=j.toString(e);return{message:"This pattern is type "+u+" but the data is type "+t+".",kind:"Type",location:y.$$location(j.toLocation(e)),path:C(n),exn:void 0}}function Ir(r,e,n,t){var u=hr(r),a=j.toString(e);return{message:'"'+n+'" is type '+a+" but the data is type "+u+".",kind:"Type",location:y.$$location(j.toLocation(e)),path:C(t),exn:void 0}}function xe(r,e,n){return{message:'"'+e+'" is bound multiple times in this pattern.',kind:"Pattern",location:y.$$location(r),path:C(n),exn:void 0}}function Ue(r,e){return{message:"None of the patterns match the data. Consider a catch-all case to avoid this.",kind:"Pattern",location:y.$$location(r),path:C(e),exn:void 0}}function Ve(r,e){return{message:"The number of patterns does not match the number of data.",kind:"Pattern",location:y.$$location(r),path:C(e),exn:void 0}}function Ne(r,e,n,t){var u=hr(n);return{message:'"'+e+'" is type '+u+". I can only echo strings and numbers.",kind:"Render",location:y.$$location(r),path:C(t),exn:void 0}}function jr(r,e,n){return{message:'Binding "'+e+'" does not exist.',kind:"Render",location:y.$$location(r),path:C(n),exn:void 0}}function Or(r,e,n){return{message:'Template child "'+e+'" does not exist.',kind:"Render",location:y.$$location(r),path:C(n),exn:void 0}}function ke(r,e,n,t){var u=hr(n);return{message:'"'+e+'" is a '+u+". I can only map arrays.",kind:"Type",location:y.$$location(r),path:C(t),exn:void 0}}function Se(r,e){return{message:"An exception was thrown while compiling this template. This is probably due to malformed input.",kind:"Compile",location:void 0,path:[e],exn:w(r)}}function Qe(r,e){return{message:"An exception was thrown while rendering a template component.",kind:"Render",location:void 0,path:C(e),exn:w(r)}}function De(r){return{message:'The template component name "'+r+'" was used twice. Every component needs a unique name.',kind:"Compile",location:void 0,path:[],exn:void 0}}function $r(r,e){return{message:r,kind:"Render",location:void 0,path:C(e),exn:void 0}}function Re(r){var e=parseFloat(r);if(!isNaN(e))return e}function h(r){return{length:0,first:void 0,last:void 0}}function Wr(r){r.length=0,r.first=void 0,r.last=void 0}function o(r,e){var n={content:e,next:void 0},t=r.last;t!==void 0?(r.length=r.length+1|0,t.next=n,r.last=n):(r.length=1,r.first=n,r.last=n)}function Ie(r){var e=r.first;if(e!==void 0)return e.content;throw{RE_EXN_ID:"Not_found",Error:new Error}}function je(r){var e=r.first;if(e!==void 0){var n=e.next;return n===void 0?(Wr(r),e.content):(r.length=r.length-1|0,r.first=n,e.content)}throw{RE_EXN_ID:"Not_found",Error:new Error}}function O(r){return r.length===0}function gr(r,e){for(var n=r.first;;){var t=n;if(t===void 0)return;e(t.content),n=t.next}}function S(r,e){if(!(r.length<=0)){var n=e.last;return n!==void 0?(e.length=e.length+r.length|0,n.next=r.first,e.last=r.last,Wr(r)):(e.length=r.length,e.first=r.first,e.last=r.last,Wr(r))}}function Dn(r,e,n){for(;;){var t=n,u=r;if(t===void 0)return;e[u]=t.content,n=t.next,r=u+1|0}}function A(r){var e=new Array(r.length);return Dn(0,e,r.first),e}function ir(r){for(var e={length:0,first:void 0,last:void 0},n=0,t=r.length;n<t;++n)o(e,r[n]);return e}function $(r,e){return r.str.charAt(r.position+e|0)}function Pr(r){return r.str.charAt(r.position)}function T(r){r.position=r.position+1|0}function Oe(r){var e=Pr(r);return T(r),e}function Rn(r,e){for(var n=r.position;!e(r.str.charAt(n));)n=n+1|0;return n}function yr(r,e){r.position=r.position+e|0}function Fr(r,e){var n=r.position,t=Rn(r,e);return r.position=t,r.str.slice(n,t)}function W(r,e){var n=r.position;return r.position=r.position+e|0,r.str.slice(n,r.position)}function In(r){switch(r){case"+":case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"E":case"e":return!1;default:return!0}}function Lr(r,e){for(var n=r.position,t=0;;){var u=t,a=$(r,u);switch(a){case"":return o(e,{TAG:0,_0:n,_1:W(r,u)}),3;case"{":var i=$(r,u+1|0);switch(i){case"%":return o(e,{TAG:0,_0:n,_1:W(r,u)}),yr(r,2),1;case"*":return o(e,{TAG:0,_0:n,_1:W(r,u)}),yr(r,2),2;case"{":return o(e,{TAG:0,_0:n,_1:W(r,u)}),yr(r,2),0;default:t=u+2|0;continue}default:t=u+1|0;continue}}}function jn(r,e){for(var n=r.position,t=0,u=0;;){var a=u,i=t,f=$(r,i);switch(f){case"":return Te(n,e);case"*":var l=$(r,i+1|0);if(l==="}"){if(a===0){var c=W(r,i);return yr(r,2),c}u=a-1|0,t=i+2|0;continue}t=i+2|0;continue;case"{":var s=$(r,i+1|0);if(s==="*"){u=a+1|0,t=i+2|0;continue}t=i+1|0;continue;default:t=i+1|0;continue}}}var On=/\\"/g;function $n(r,e){for(var n=r.position,t=0;;){var u=t,a=$(r,u);switch(a){case"":return be(n,e);case'"':var i=W(r,u).replace(On,'"');return T(r),i;case"\\":var f=$(r,u+1|0);switch(f){case'"':case"\\":t=u+2|0;continue;default:t=u+1|0;continue}default:t=u+1|0;continue}}}function Wn(r,e){var n=r.position,t=Fr(r,In),u=Re(t);return u!==void 0?u:Be(n,e,t)}var Pn=/^[a-zA-Z0-9_]$/;function $e(r){return!Pn.test(r)}var Fn=/^[a-z_]$/,Jn=/^[A-Z]$/;function zn(r,e){var n=Fr(r,$e);switch(n){case"false":return{TAG:5,_0:e};case"null":return{TAG:6,_0:e};case"true":return{TAG:4,_0:e};default:return{TAG:18,_0:e,_1:n}}}function We(r,e,n,t){for(var u=!0;u;){var a=r.position,i=Pr(r),f=0;if(i===t)T(r),u=!1;else switch(i){case"":Ee(a,n);break;case"	":case`
`:case"\r":case" ":T(r);break;case'"':T(r),o(e,{TAG:2,_0:a,_1:$n(r,n)});break;case"#":T(r),o(e,{TAG:16,_0:a});break;case"&":T(r),o(e,{TAG:21,_0:a});break;case",":T(r),o(e,{TAG:7,_0:a});break;case".":var l=W(r,3);l==="..."?o(e,{TAG:13,_0:a}):pr(a,n,l,"...");break;case"/":T(r),o(e,{TAG:15,_0:a});break;case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":f=1;break;case":":T(r),o(e,{TAG:8,_0:a});break;case"=":T(r),o(e,{TAG:17,_0:a});break;case"?":T(r),o(e,{TAG:20,_0:a});break;case"[":T(r),o(e,{TAG:9,_0:a});break;case"]":T(r),o(e,{TAG:10,_0:a});break;case"{":T(r),o(e,{TAG:11,_0:a});break;case"}":T(r),o(e,{TAG:12,_0:a});break;case"~":T(r),o(e,{TAG:19,_0:a});break;default:Fn.test(i)?o(e,zn(r,a)):Jn.test(i)?o(e,{TAG:14,_0:a,_1:Fr(r,$e)}):we(a,n,i)}f===1&&o(e,{TAG:3,_0:a,_1:Wn(r,n)})}}function Pe(r,e){for(var n={str:e,position:0},t=h(void 0),u=Lr(n,t);;){var a=u;switch(a){case 0:var i=n.position;Pr(n)==="~"&&(o(t,{TAG:19,_0:n.position}),T(n)),o(t,{TAG:22,_0:i}),We(n,t,r,"}");var f=Oe(n);if(f!=="}")return pr(n.position,r,f,"}");u=Lr(n,t);continue;case 1:We(n,t,r,"%");var l=Oe(n);if(l!=="}")return pr(n.position,r,l,"}");u=Lr(n,t);continue;case 2:var c=n.position;o(t,{TAG:1,_0:c,_1:jn(n,r)}),u=Lr(n,t);continue;case 3:return o(t,{TAG:23,_0:n.position}),{tokens:t,name:r}}}}function Er(r){return Ie(r.tokens)}function v(r){return je(r.tokens)}function g(r){return r.name}var Kn=mr("Caml_js_exceptions.Error");function Tr(r){return Le(r)?r:{RE_EXN_ID:Kn,_1:r}}function Q(r,e){switch(r.TAG|0){case 2:return{NAME:"String",VAL:[r._0,r._1]};case 3:return{NAME:"Number",VAL:[r._0,r._1]};case 4:return{NAME:"True",VAL:r._0};case 5:return{NAME:"False",VAL:r._0};case 6:return{NAME:"Null",VAL:r._0};case 9:var n=r._0,t=v(e);if(t.TAG===10)return{NAME:"Array",VAL:[n,[]]};var u=h(void 0);o(u,Q(t,e));for(var a;;){var i=v(e);switch(i.TAG|0){case 7:var f=v(e);if(f.TAG===13){var l=v(e);if(l.TAG!==18)return L(l,g(e));var c=v(e);return c.TAG===10?{NAME:"ArrayWithTailBinding",VAL:[n,A(u),{NAME:"Binding",VAL:[l._0,l._1]}]}:L(c,g(e))}o(u,Q(f,e)),a=void 0;continue;case 10:return{NAME:"Array",VAL:[n,A(u)]};default:return L(i,g(e))}}case 11:var s=r._0,_=v(e);if(_.TAG===12)return{NAME:"Object",VAL:[s,[]]};var d=h(void 0);o(d,Fe(_,e));for(var p;;){var m=v(e);switch(m.TAG|0){case 7:o(d,Fe(v(e),e)),p=void 0;continue;case 12:return{NAME:"Object",VAL:[s,A(d)]};default:return L(m,g(e))}}case 18:return{NAME:"Binding",VAL:[r._0,r._1]};default:return L(r,g(e))}}function Fe(r,e){switch(r.TAG|0){case 2:var n=v(e);return n.TAG===8?[r._1,Q(v(e),e)]:L(n,g(e));case 18:var t=r._1,u=Er(e);return u.TAG!==8?[t,{NAME:"Binding",VAL:[r._0,t]}]:(v(e),[t,Q(v(e),e)]);default:return L(r,g(e))}}function zr(r){for(var e=Q(v(r),r),n=h(void 0),t;;){var u=Er(r);if(u.TAG!==7)return{_0:e,_1:A(n)};v(r),o(n,Q(v(r),r)),t=void 0}}function Je(r){var e=v(r);return e.TAG===18?[e._0,e._1]:L(e,g(r))}function Hn(r){for(var e=Je(r),n=h(void 0),t;;){var u=Er(r);if(u.TAG!==7)return{_0:e,_1:A(n)};v(r),o(n,Je(r)),t=void 0}}function ze(r,e,n){switch(r.TAG|0){case 2:return{TAG:2,_0:r._1,_1:n};case 3:return{TAG:3,_0:r._1,_1:n};case 18:return{TAG:0,_0:r._0,_1:r._1,_2:n};default:return L(r,g(e))}}function Ke(r){var e=v(r);switch(e.TAG|0){case 14:return{TAG:1,_0:e._0,_1:e._1};case 21:return ze(v(r),r,0);default:return ze(e,r,1)}}function Zn(r){for(var e=Ke(r),n=h(void 0),t;;){var u=v(r);switch(u.TAG|0){case 0:case 19:return[u,{_0:e,_1:A(n)}];case 20:o(n,Ke(r)),t=void 0;continue;default:return L(u,g(r))}}}function Xn(r){switch(r.TAG|0){case 15:return!0;case 18:return r._1==="with";default:return!1}}function Yn(r){return r.TAG===23}function He(r){return r.TAG===15}function br(r,e,n){for(var t=h(void 0),u=r;;){var a=u;if(n(a))return[a,A(t)];switch(a.TAG|0){case 0:var i=a._1,f=v(e);if(f.TAG===19){o(t,{TAG:0,_0:i,_1:1}),u=v(e);continue}o(t,{TAG:0,_0:i,_1:3}),u=f;continue;case 1:u=v(e);continue;case 14:o(t,qn(a._0,a._1,e)),u=v(e);continue;case 18:var l=a._0;switch(a._1){case"map":var c=Q(v(e),e),s=c.NAME;if(!(s==="Array"||s==="ArrayWithTailBinding"||s==="Binding"))return Me(c,g(e));var _=Ze(e,"map");o(t,{TAG:3,_0:l,_1:c,_2:_}),u=v(e);continue;case"match":var d=Hn(e),p=Ze(e,"match");o(t,{TAG:2,_0:l,_1:d,_2:p}),u=v(e);continue;default:return L(a,g(e))}case 19:var m=v(e);if(m.TAG!==0)return L(m,g(e));var b=m._1,E=v(e);if(E.TAG===19){o(t,{TAG:0,_0:b,_1:2}),u=v(e);continue}o(t,{TAG:0,_0:b,_1:0}),u=E;continue;case 22:var G=Zn(e);o(t,{TAG:1,_0:a._0,_1:G[1]}),u=G[0];continue;default:return L(a,g(e))}}}function Xe(r){for(var e=zr(r),n=h(void 0),t;;){var u=v(r);if(u.TAG===18&&u._1==="with"){o(n,zr(r)),t=void 0;continue}var a=br(u,r,Xn);return[a[0],{patterns:{_0:e,_1:A(n)},ast:a[1]}]}}function Ze(r,e){var n=v(r);if(n.TAG!==18)return L(n,g(r));if(n._1!=="with")return L(n,g(r));for(var t=Xe(r),u=t[1],a=h(void 0),i=t[0];;){var f=i;if(f.TAG===15){var l=v(r);return l.TAG===18&&l._1===e?{_0:u,_1:A(a)}:L(l,g(r))}var c=Xe(r);o(a,c[1]),i=c[0]}}function qn(r,e,n){var t=rt(n),u=t[2],a=t[1],i=t[0];if(i.TAG===15)return{TAG:4,loc:r,name:e,props:A(a),children:A(u)};var f=br(i,n,He),l=v(n);return l.TAG===14&&e===l._1?(o(u,["Children",{TAG:1,_0:f[1]}]),{TAG:4,loc:r,name:e,props:A(a),children:A(u)}):L(l,g(n))}function rt(r){for(var e=h(void 0),n=h(void 0),t=v(r);;){var u=t;switch(u.TAG|0){case 14:var a=u._1,i=v(r);if(i.TAG===17){var f=v(r);switch(f.TAG|0){case 14:o(n,[a,{TAG:0,_0:f._1}]),t=v(r);continue;case 16:var l=br(v(r),r,He),c=v(r);if(c.TAG!==16)return L(c,g(r));o(n,[a,{TAG:1,_0:l[1]}]),t=v(r);continue;default:return L(f,g(r))}}else{o(n,[a,{TAG:0,_0:a}]),t=i;continue}case 18:var s=u._1,_=v(r);if(_.TAG===17){var d=Q(v(r),r);o(e,[s,d]),t=v(r);continue}o(e,[s,{NAME:"Binding",VAL:[u._0,s]}]),t=_;continue;default:return[u,e,n]}}}function Kr(r,e){try{var n=Pe(r,e),t=br(v(n),n,Yn);return{NAME:"ok",VAL:{ast:t[1],name:r}}}catch(a){var u=Tr(a);return u.RE_EXN_ID===k?{NAME:"errors",VAL:[u._1]}:{NAME:"errors",VAL:[Se(u,r)]}}}function Ye(r){switch(r.TAG|0){case 0:return I(Kr(r.name,r.src),function(e,n,t,u){return n.render(e,t,u)});case 1:return{NAME:"ok",VAL:r.f};case 2:return I(Kr(r.name,r.src),r.f)}}function et(r){var e=h(void 0),n=de(r,void 0,function(t,u){var a=Ye(u);if(a.NAME==="ok"){var i=Nr(u);return Ar(t,i)?(o(e,De(i)),t):Y(t,i,a.VAL)}return S(ir(a.VAL),e),t});return O(e)?{NAME:"ok",VAL:n}:{NAME:"errors",VAL:A(e)}}var nt={make:zr},tt;var qr={};vr(qr,{Async:()=>bt,make:()=>mt});function P(r,e){if(e in r)return w(r[e])}function fr(r){var e=typeof r;return e==="string"?{TAG:0,_0:r}:e==="number"?{TAG:1,_0:r}:e==="boolean"?r===!0?1:0:r===null?2:Array.isArray(r)?{TAG:3,_0:r}:{TAG:2,_0:r}}function q(r,e){return r.TAG===0?{TAG:0,_0:e(r._0)}:{TAG:1,_0:r._0}}function qe(r,e){return r.TAG===0?e(r._0):{TAG:1,_0:r._0}}function Hr(r,e){for(var n=h(void 0),t=0;;){var u=t,a=U(r,u);if(a===void 0)return{TAG:0,_0:n};var i=e(M(a));if(i.TAG!==0)return i;o(n,i._0),t=u+1|0}}function Br(r,e,n){var t=r.NAME;if(t==="Object")return q(Hr(r.VAL[1],function(f){var l=f[0];return q(Br(f[1],e,n),function(c){return[l,c]})}),function(f){var l={};return gr(f,function(c){l[c[0]]=c[1]}),l});if(t!=="Binding")return t==="False"?{TAG:0,_0:!1}:t==="Array"||t==="ArrayWithTailBinding"?q(rn(r,e,n),function(f){return f}):t==="Null"?{TAG:0,_0:null}:t==="True"?{TAG:0,_0:!0}:{TAG:0,_0:r.VAL[1]};var u=r.VAL,a=u[1],i=P(e,a);return i!==void 0?{TAG:0,_0:M(i)}:{TAG:1,_0:jr(u[0],a,n)}}function rn(r,e,n){if(r.NAME==="Array")return q(Hr(r.VAL[1],function(c){return Br(c,e,n)}),A);var t=r.VAL,u=t[2].VAL,a=u[1],i=P(e,a);if(i===void 0)return{TAG:1,_0:jr(u[0],a,n)};var f=fr(M(i));if(typeof f=="number")return{TAG:1,_0:Ir(f,r,a,n)};if(f.TAG!==3)return{TAG:1,_0:Ir(f,r,a,n)};var l=f._0;return q(Hr(t[1],function(c){return Br(c,e,n)}),function(c){return ve(A(c),l)})}function en(r,e,n,t){return e==="_"?{TAG:0,_0:r}:Ar(r,e)?{TAG:1,_0:{TAG:1,loc:t,binding:e}}:{TAG:0,_0:Y(r,e,n)}}function Zr(r,e,n){var t=fr(e),u=r.NAME;if(u==="Object"){var a=r.VAL[1];if(a.length!==0){if(typeof t=="number")return t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}};if(t.TAG===2)for(var i=t._0,f=n,l=0;;){var c=l,s=f,_=U(a,c);if(_===void 0)return{TAG:0,_0:s};var d=P(i,_[0]);if(d===void 0)return{TAG:1,_0:0};var p=Zr(_[1],M(d),s);if(p.TAG!==0)return p;l=c+1|0,f=p._0}else return{TAG:1,_0:{TAG:0,data:t,pattern:r}}}else return typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===2?Object.keys(t._0).length===0?{TAG:0,_0:n}:{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}}if(u==="Binding"){var m=r.VAL;return en(n,m[1],e,m[0])}if(u==="Number")return typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===1?r.VAL[1]===t._0?{TAG:0,_0:n}:{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}};if(u==="False"){if(typeof t!="number")return{TAG:1,_0:{TAG:0,data:t,pattern:r}};switch(t){case 0:return{TAG:0,_0:n};case 1:case 2:return{TAG:1,_0:0}}}else if(u==="ArrayWithTailBinding"){var b=r.VAL,E=b[2].VAL,G=E[1],D=E[0],F=b[1];if(typeof t=="number")return t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}};if(t.TAG!==3)return{TAG:1,_0:{TAG:0,data:t,pattern:r}};var J=t._0;return qe(nn(F,J,n),function(lr){return en(lr,G,se(J,F.length),D)})}else{if(u==="Null")return typeof t=="number"&&t>=2?{TAG:0,_0:n}:{TAG:1,_0:0};if(u==="True"){if(typeof t!="number")return{TAG:1,_0:{TAG:0,data:t,pattern:r}};switch(t){case 1:return{TAG:0,_0:n};case 0:case 2:return{TAG:1,_0:0}}}else{if(u!=="Array")return typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===0?r.VAL[1]===t._0?{TAG:0,_0:n}:{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}};var er=r.VAL[1];return er.length!==0?typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===3?nn(er,t._0,n):{TAG:1,_0:{TAG:0,data:t,pattern:r}}:typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===3?t._0.length!==0?{TAG:1,_0:0}:{TAG:0,_0:n}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}}}}function nn(r,e,n){for(var t=n,u=0;;){var a=u,i=t,f=U(r,a);if(f===void 0)return{TAG:0,_0:i};var l=U(e,a);if(l===void 0)return{TAG:1,_0:0};var c=Zr(f,M(l),i);if(c.TAG!==0)return c;u=a+1|0,t=c._0}}function ut(r,e){for(var n=e._1,t=r._1,u=r._0,a=e._0,i,f=0;;){var l=f,c=i,s=a,_=u,d=Zr(_,s,c);if(d.TAG!==0)return d;var p=d._0,m=U(t,l),b=U(n,l);if(m!==void 0){if(b===void 0)return{TAG:1,_0:1};f=l+1|0,i=p,a=M(b),u=m;continue}if(b!==void 0)return{TAG:1,_0:1};var E={};return pe(p,function(G){return function(D,F){G[D]=F}}(E)),{TAG:0,_0:E}}}function at(r,e){for(var n=r.f,t=r.patterns,u=t._1,a=t._0,i=0;;){var f=i,l=a,c=ut(l,e);if(c.TAG===0)return{TAG:0,_0:n(c._0)};if(c._0!==0)return c;var s=U(u,f);if(s===void 0)return{TAG:1,_0:0};i=f+1|0,a=s}}function it(r,e){for(var n=r._1,t=r._0,u=0;;){var a=u,i=t,f=at(i,e);if(f.TAG===0||f._0!==0)return f;var l=U(n,a);if(l===void 0)return{TAG:1,_0:0};u=a+1|0,t=l}}function ft(r){switch(r){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&apos;";case"/":return"&#x2F;";case"<":return"&lt;";case"=":return"&#x3D;";case">":return"&gt;";case"`":return"&#x60;";default:return r}}function Xr(r,e){if(r)for(var n=0,t="";;){var u=t,a=n,i=e.charAt(a);if(i==="")return u;t=u+ft(i),n=a+1|0}else return e}function Yr(r,e){var n=P(r,e);return n!==void 0?M(n):null}function lt(r,e){var n=fr(Yr(r,e));if(typeof n=="number")return{TAG:1,_0:n};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:0,_0:String(n._0)};default:return{TAG:1,_0:n}}}function ot(r){return function(e){return e._1.length!==0?e:{_0:e._0,_1:[{NAME:"Binding",VAL:[r,"_"]}]}}}function tn(r,e,n,t){var u=it(r,e);if(u.TAG===0)return u;var a=u._0;return typeof a=="number"?a===0?{TAG:1,_0:Ue(n,t)}:{TAG:1,_0:Ve(n,t)}:a.TAG===0?{TAG:1,_0:Ge(a.data,a.pattern,t)}:{TAG:1,_0:xe(a.loc,a.binding,t)}}function un(r){for(var e=0;;){var n=e,t=r.charAt(n);switch(t){case"	":case`
`:case"\r":case" ":e=n+1|0;continue;default:return r.slice(n)}}}function an(r){for(var e=r.length;;){var n=e,t=r.charAt(n-1|0);switch(t){case"	":case`
`:case"\r":case" ":e=n-1|0;continue;default:return r.slice(0,n)}}}function ct(r,e,n,t,u,a,i){for(var f=r,l=0;;){var c=l,s=f;switch(s.TAG|0){case 0:var _=s._1,d=lt(n,_);if(d.TAG===0)return a.return(Xr(s._2,d._0));var p=d._0,m=U(e,c);if(typeof p=="number"&&p>=2&&m!==void 0){l=c+1|0,f=m;continue}return i([Ne(s._0,_,p,t)]);case 1:var b=s._1,E=P(u,b);if(E!==void 0)return M(E);var G=U(e,c);if(G===void 0)return i([Or(s._0,b,t)]);l=c+1|0,f=G;continue;case 2:return a.return(Xr(s._1,s._0));case 3:return a.return(Xr(s._1,String(s._0)))}}}function rr(r,e,n,t,u,a,i,f){var l=t.stack,c=t.components,s=u(t),_=h(void 0);return Z(r,function(d){switch(d.TAG|0){case 0:var p=d._0,m;switch(d._1){case 0:m=un(p);break;case 1:m=an(p);break;case 2:m=un(an(p));break;case 3:m=p;break}return o(_,s.return(m));case 1:var b=d._1;return o(_,ct(b._0,b._1,e,l,n,s,a));case 2:var E=ar.map(d._2,function(B){var x=B.ast;return{patterns:B.patterns,f:function(R){return rr(x,Object.assign({},e,R),n,{components:t.components,stack:{hd:0,tl:l}},u,a,i,f)}}}),G=ar.map(d._1,function(B){return Yr(e,B[1])}),D=tn(E,G,d._0,l);return D.TAG===0?S(D._0,_):o(_,a([D._0]));case 3:var F=d._2,J=d._1,er=d._0,lr=J.NAME,nr;if(lr==="Array"||lr==="ArrayWithTailBinding")nr=rn(J,e,l);else{var ne=J.VAL,te=ne[1],dn=ne[0],or=fr(Yr(e,te));nr=typeof or=="number"||or.TAG!==3?{TAG:1,_0:ke(dn,te,or,l)}:{TAG:0,_0:or._0}}return nr.TAG===0?_e(nr._0,function(B,x){var R=ar.map(F,function(tr){var An=tr.ast;return{patterns:ar.map(tr.patterns,ot(er)),f:function(mn){return rr(An,Object.assign({},e,mn),n,{components:t.components,stack:{hd:{TAG:2,_0:B},tl:{hd:1,tl:l}}},u,a,i,f)}}}),z=tn(R,{_0:x,_1:[B]},er,l);return z.TAG===0?S(z._0,_):o(_,a([z._0]))}):o(_,a([nr._0]));case 4:var wr=d.name,ue=d.loc,ae=he(c,wr);if(ae===void 0)return o(_,a([Ce(ue,wr,l)]));var ie={},Mr={},cr=h(void 0);return Z(d.children,function(B){var x=B[1],R=B[0];if(x.TAG===0){var z=x._0,tr=P(n,z);if(tr!==void 0){Mr[R]=M(tr);return}else return o(cr,Or(ue,z,l))}Mr[R]=f(rr(x._0,e,n,{components:t.components,stack:{hd:{TAG:1,component:wr,section:R},tl:l}},u,a,i,f))}),Z(d.props,function(B){var x=Br(B[1],e,l);if(x.TAG!==0)return o(cr,x._0);ie[B[0]]=x._0}),O(cr)?o(_,i(function(){return ae(s,ie,Mr)},function(B){return a([Qe(B,l)])})):o(_,a(A(cr)))}}),_}function fn(r){return ge(r,function(e){return K(e)})}function vt(r){return{NAME:"ok",VAL:r}}function st(r){return{NAME:"errors",VAL:r}}function _t(r,e){try{return r()}catch(t){var n=Tr(t);return e(n)}}var dt=I,At=Ur;function ln(r){var e={contents:""},n=h(void 0);return gr(r,function(t){if(t.NAME==="ok"){e.contents=e.contents+t.VAL;return}else return S(ir(t.VAL),n)}),O(n)?{NAME:"ok",VAL:e.contents}:{NAME:"errors",VAL:A(n)}}function on(r){var e=r.stack,n=r.components;return{render:function(t,u,a){return ln(rr(t.ast,u,a,{components:n,stack:{hd:{TAG:0,_0:t.name},tl:e}},on,st,_t,ln))},return:vt,error:function(t){return{NAME:"errors",VAL:[$r(t,e)]}},mapChild:dt,flatMapChild:At}}function mt(r){return on({components:fn(r),stack:0})}function pt(r){return Promise.resolve({NAME:"ok",VAL:r})}function ht(r){return Promise.resolve({NAME:"errors",VAL:r})}function gt(r,e){return r().catch(function(n){return e(n)})}function yt(r,e){return r.then(function(n){return Promise.resolve(I(n,e))})}function Lt(r,e){return r.then(function(n){return n.NAME==="ok"?Gr(e,n.VAL):Promise.resolve(n)})}function Et(r){var e={contents:""},n=h(void 0);return Z(r,function(t){if(t.NAME==="ok"){e.contents=e.contents+t.VAL;return}else return S(ir(t.VAL),n)}),O(n)?Promise.resolve({NAME:"ok",VAL:e.contents}):Promise.resolve({NAME:"errors",VAL:A(n)})}function cn(r){return Promise.all(A(r)).then(Et)}function vn(r){var e=r.stack,n=r.components;return{render:function(t,u,a){return cn(rr(t.ast,u,a,{components:n,stack:{hd:{TAG:0,_0:t.name},tl:e}},vn,ht,gt,cn))},return:pt,error:function(t){return Promise.resolve({NAME:"errors",VAL:[$r(t,e)]})},mapChild:yt,flatMapChild:Lt}}function Tt(r){return vn({components:fn(r),stack:0})}var bt={make:Tt};var re=Jr,sn=qr,ee=xr,_n=Vr;window.onload=function(e){var n=document.getElementById("props"),t=document.getElementById("source"),u=document.getElementById("source-is-dirty"),a=document.getElementById("props-is-dirty");function i(_){_.textContent="*"}function f(_){_.textContent=""}n.oninput=function(_){i(a)},t.oninput=function(_){i(u)},n.value=JSON.stringify({name:null,objects:[{name:"sky",color:"blue"},{name:"grass",color:"purple"},{name:"air"}]},null,2),t.value=`Hello {{ name ? "dear user" }},

{% map objects with {name, color} ~%}
  Have you noticed the {{ name }} is {{ color }} today?
{% match name, color
   with "sky", "blue"
   with "grass", "green" ~%}
  That's an ordinary color for it.
{% with _, _ ~%}
  That seems odd.
{% /match %}
{% with {name} ~%}
  The {{ name }}, I suppose, has no color.
{%~ /map %}
`;var l=sn.make(re.emptyMap),c=document.getElementById("result");function s(_){try{var d=JSON.parse(n.value),p=_n.string("Playground",t.value),m=re.make(p),b=ee.flatMap(m,E=>E(l,d,{}));c.value=ee.getOrElse(b,E=>`Errors:
`+JSON.stringify(E,null,2))}catch(E){c.value=E.message}f(a),f(u)}document.getElementById("render").onclick=s,s()};
//# sourceMappingURL=playground.js.map

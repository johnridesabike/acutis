var He=Object.defineProperty;var Ze=(r,e)=>{for(var n in e)He(r,n,{get:e[n],enumerable:!0})};function b(r){return r===void 0?{BS_PRIVATE_NESTED_SOME_NONE:0}:r!==null&&r.BS_PRIVATE_NESTED_SOME_NONE!==void 0?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function w(r){if(!(r!==null&&r.BS_PRIVATE_NESTED_SOME_NONE!==void 0))return r;var e=r.BS_PRIVATE_NESTED_SOME_NONE;if(e!==0)return{BS_PRIVATE_NESTED_SOME_NONE:e-1|0}}function zr(r,e){return r>e?r:e}function U(r,e){if(e>=0&&e<r.length)return b(r[e])}function Kr(r,e){for(var n=r.length,t=e.length,u=new Array(n+t|0),a=0;a<n;++a)u[a]=r[a];for(var i=0;i<t;++i)u[n+i|0]=e[i];return u}function Hr(r,e){for(var n=r.length,t=e<0?zr(n+e|0,0):e,u=n-t|0,a=new Array(u),i=0;i<u;++i)a[i]=r[t+i|0];return a}function k(r,e){for(var n=0,t=r.length;n<t;++n)e(r[n])}function ir(r,e){for(var n=r.length,t=new Array(n),u=0;u<n;++u)t[u]=e(r[u]);return t}function Zr(r,e){for(var n=0,t=r.length;n<t;++n)e(n,r[n])}function Xe(r){for(var e=r,n=0;;){var t=n,u=e;if(!u)return t;n=t+1|0,e=u.tl}}function Ye(r,e,n){for(;;){var t=n,u=e;if(!t)return;r[u]=t.hd,n=t.tl,e=u+1|0}}function Xr(r){var e=Xe(r),n=new Array(e);return Ye(n,0,r),n}var Er={contents:0};function fr(r){return Er.contents=Er.contents+1|0,r+("/"+Er.contents)}function Yr(r){return r==null?!1:typeof r.RE_EXN_ID=="string"}function qe(r,e){return{_0:e(r._0),_1:ir(r._1,e)}}var rr={map:qe};function rn(r){return{character:r+1|0}}function en(r){if(typeof r=="number")return r===0?"match":"map";switch(r.TAG|0){case 0:var e=r._0;return e!==void 0?e:null;case 1:return"section: "+r.component+"#"+r.section;case 2:return r._0}}var nn={nameToJson:en},g={$$location:rn,Stack:nn};function tn(r){switch(r.TAG|0){case 0:return"[text]: "+r._1;case 1:return"{*"+r._1+"*}";case 2:return'"'+r._1+'"';case 3:return String(r._1);case 4:return"true";case 5:return"false";case 6:return"null";case 7:return",";case 8:return":";case 9:return"[";case 10:return"]";case 11:return"{";case 12:return"}";case 13:return"...";case 15:return"/";case 16:return"#";case 17:return"=";case 14:case 18:return r._1;case 19:return"~";case 20:return"?";case 21:return"&";case 22:return"{{";case 23:return"[end of file]"}}function un(r){return r._0}var Tr={toString:tn,toLocation:un};function an(r){return{data:r,acutis_is_valid:"ACUTIS_IS_VALID"}}function fn(r){if(r.acutis_is_valid==="ACUTIS_IS_VALID")return b(r.data)}var R={make:an,validate:fn};function ln(r){var e=r.NAME;return e==="Object"?"object":e==="Binding"?"binding: `"+r.VAL[1]+"`":e==="Number"?"number":e==="True"||e==="False"?"boolean":e==="Array"||e==="ArrayWithTailBinding"?"array":e==="Null"?"null":"string"}function on(r){var e=r.NAME;return e==="True"||e==="Null"||e==="False"?r.VAL:r.VAL[0]}var j={toString:ln,toLocation:on};function C(r){return ir(Xr(r),g.Stack.nameToJson)}var V=fr("Debug-AcutisLang.CompileError");function qr(r,e){throw{RE_EXN_ID:V,_1:{message:"Unexpected end of file.",kind:"Syntax",location:g.$$location(r),path:[e!==void 0?e:null],exn:void 0},Error:new Error}}function re(r,e){throw{RE_EXN_ID:V,_1:{message:"Unterminated comment.",kind:"Syntax",location:g.$$location(r),path:[e!==void 0?e:null],exn:void 0},Error:new Error}}function ee(r,e){throw{RE_EXN_ID:V,_1:{message:"Unterminated string.",kind:"Syntax",location:g.$$location(r),path:[e!==void 0?e:null],exn:void 0},Error:new Error}}function ne(r,e,n){throw{RE_EXN_ID:V,_1:{message:'"'+n+'" is an illegal identifier name.',kind:"Parse",location:g.$$location(r),path:[e!==void 0?e:null],exn:void 0},Error:new Error}}function te(r,e,n){throw{RE_EXN_ID:V,_1:{message:'Invalid character: "'+n+'".',kind:"Syntax",location:g.$$location(r),path:[e!==void 0?e:null],exn:void 0},Error:new Error}}function lr(r,e,n,t){throw{RE_EXN_ID:V,_1:{message:'Unexpected character: "'+n+'". Expected: "'+t+'".',kind:"Syntax",location:g.$$location(r),path:[e!==void 0?e:null],exn:void 0},Error:new Error}}function y(r,e){throw{RE_EXN_ID:V,_1:{message:'Unexpected token: "'+Tr.toString(r)+'".',kind:"Parse",location:g.$$location(Tr.toLocation(r)),path:[e!==void 0?e:null],exn:void 0},Error:new Error}}function ue(r,e){throw{RE_EXN_ID:V,_1:{message:'Bad map type: "'+j.toString(r)+'". I can only map bindings and arrays.',kind:"Parse",location:g.$$location(j.toLocation(r)),path:[e!==void 0?e:null],exn:void 0},Error:new Error}}function or(r){if(typeof r=="number")switch(r){case 0:case 1:return"boolean";case 2:return"null"}else switch(r.TAG|0){case 0:return"string";case 1:return"number";case 2:return"object";case 3:return"array"}}function ae(r,e,n){return{message:'Component "'+e+'" does not exist.',kind:"Render",location:g.$$location(r),path:C(n),exn:void 0}}function ie(r,e,n){var t=or(r),u=j.toString(e);return{message:"This pattern is type "+u+" but the data is type "+t+".",kind:"Type",location:g.$$location(j.toLocation(e)),path:C(n),exn:void 0}}function br(r,e,n,t){var u=or(r),a=j.toString(e);return{message:'"'+n+'" is type '+a+" but the data is type "+u+".",kind:"Type",location:g.$$location(j.toLocation(e)),path:C(t),exn:void 0}}function fe(r,e,n){return{message:'"'+e+'" is bound multiple times in this pattern.',kind:"Pattern",location:g.$$location(r),path:C(n),exn:void 0}}function le(r,e){return{message:"None of the patterns match the data. Consider a catch-all case to avoid this.",kind:"Pattern",location:g.$$location(r),path:C(e),exn:void 0}}function oe(r,e){return{message:"The number of patterns does not match the number of data.",kind:"Pattern",location:g.$$location(r),path:C(e),exn:void 0}}function ce(r,e,n,t){var u=or(n);return{message:'"'+e+'" is type '+u+". I can only echo strings and numbers.",kind:"Render",location:g.$$location(r),path:C(t),exn:void 0}}function Br(r,e,n){return{message:'Binding "'+e+'" does not exist.',kind:"Render",location:g.$$location(r),path:C(n),exn:void 0}}function wr(r,e,n){return{message:'Template child "'+e+'" does not exist.',kind:"Render",location:g.$$location(r),path:C(n),exn:void 0}}function ve(r,e,n,t){var u=or(n);return{message:'"'+e+'" is a '+u+". I can only map arrays.",kind:"Type",location:g.$$location(r),path:C(t),exn:void 0}}function Mr(r){return{message:"A template AST was not valid. Did you forget to compile one?",kind:"Render",location:void 0,path:C(r),exn:void 0}}function se(r,e){return{message:"An exception was thrown while rendering this template. This is probably due to malformed input.",kind:"Compile",location:void 0,path:[e!==void 0?e:null],exn:b(r)}}function _e(r,e){return{message:"An exception was thrown while rendering a template component.",kind:"Render",location:void 0,path:C(e),exn:b(r)}}function Cr(r,e){return{message:r,kind:"Render",location:void 0,path:C(e),exn:void 0}}function de(r){var e=parseFloat(r);if(!isNaN(e))return e}function L(r){return{length:0,first:void 0,last:void 0}}function Gr(r){r.length=0,r.first=void 0,r.last=void 0}function o(r,e){var n={content:e,next:void 0},t=r.last;t!==void 0?(r.length=r.length+1|0,t.next=n,r.last=n):(r.length=1,r.first=n,r.last=n)}function Ae(r){var e=r.first;if(e!==void 0)return e.content;throw{RE_EXN_ID:"Not_found",Error:new Error}}function me(r){var e=r.first;if(e!==void 0){var n=e.next;return n===void 0?(Gr(r),e.content):(r.length=r.length-1|0,r.first=n,e.content)}throw{RE_EXN_ID:"Not_found",Error:new Error}}function er(r){return r.length===0}function cr(r,e){for(var n=r.first;;){var t=n;if(t===void 0)return;e(t.content),n=t.next}}function xr(r,e){if(!(r.length<=0)){var n=e.last;return n!==void 0?(e.length=e.length+r.length|0,n.next=r.first,e.last=r.last,Gr(r)):(e.length=r.length,e.first=r.first,e.last=r.last,Gr(r))}}function cn(r,e,n){for(;;){var t=n,u=r;if(t===void 0)return;e[u]=t.content,n=t.next,r=u+1|0}}function m(r){var e=new Array(r.length);return cn(0,e,r.first),e}function O(r,e){return r.str.charAt(r.position+e|0)}function Ur(r){return r.str.charAt(r.position)}function E(r){r.position=r.position+1|0}function pe(r){var e=Ur(r);return E(r),e}function vn(r,e){for(var n=r.position;!e(r.str.charAt(n));)n=n+1|0;return n}function vr(r,e){r.position=r.position+e|0}function Vr(r,e){var n=r.position,t=vn(r,e);return r.position=t,r.str.slice(n,t)}function $(r,e){var n=r.position;return r.position=r.position+e|0,r.str.slice(n,r.position)}function sn(r){switch(r){case"+":case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"E":case"e":return!1;default:return!0}}function sr(r,e){for(var n=r.position,t=0;;){var u=t,a=O(r,u);switch(a){case"":return o(e,{TAG:0,_0:n,_1:$(r,u)}),3;case"{":var i=O(r,u+1|0);switch(i){case"%":return o(e,{TAG:0,_0:n,_1:$(r,u)}),vr(r,2),1;case"*":return o(e,{TAG:0,_0:n,_1:$(r,u)}),vr(r,2),2;case"{":return o(e,{TAG:0,_0:n,_1:$(r,u)}),vr(r,2),0;default:t=u+2|0;continue}default:t=u+1|0;continue}}}function _n(r,e){for(var n=r.position,t=0,u=0;;){var a=u,i=t,f=O(r,i);switch(f){case"":return re(n,e);case"*":var l=O(r,i+1|0);if(l==="}"){if(a===0){var c=$(r,i);return vr(r,2),c}u=a-1|0,t=i+2|0;continue}t=i+2|0;continue;case"{":var s=O(r,i+1|0);if(s==="*"){u=a+1|0,t=i+2|0;continue}t=i+1|0;continue;default:t=i+1|0;continue}}}var dn=/\\"/g;function An(r,e){for(var n=r.position,t=0;;){var u=t,a=O(r,u);switch(a){case"":return ee(n,e);case'"':var i=$(r,u).replace(dn,'"');return E(r),i;case"\\":var f=O(r,u+1|0);switch(f){case'"':case"\\":t=u+2|0;continue;default:t=u+1|0;continue}default:t=u+1|0;continue}}}function mn(r,e){var n=r.position,t=Vr(r,sn),u=de(t);return u!==void 0?u:ne(n,e,t)}var pn=/^[a-zA-Z0-9_]$/;function he(r){return!pn.test(r)}var hn=/^[a-z_]$/,gn=/^[A-Z]$/;function yn(r,e){var n=Vr(r,he);switch(n){case"false":return{TAG:5,_0:e};case"null":return{TAG:6,_0:e};case"true":return{TAG:4,_0:e};default:return{TAG:18,_0:e,_1:n}}}function ge(r,e,n,t){for(var u=!0;u;){var a=r.position,i=Ur(r),f=0;if(i===t)E(r),u=!1;else switch(i){case"":qr(a,n);break;case"	":case`
`:case"\r":case" ":E(r);break;case'"':E(r),o(e,{TAG:2,_0:a,_1:An(r,n)});break;case"#":E(r),o(e,{TAG:16,_0:a});break;case"&":E(r),o(e,{TAG:21,_0:a});break;case",":E(r),o(e,{TAG:7,_0:a});break;case".":var l=$(r,3);l==="..."?o(e,{TAG:13,_0:a}):lr(a,n,l,"...");break;case"/":E(r),o(e,{TAG:15,_0:a});break;case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":f=1;break;case":":E(r),o(e,{TAG:8,_0:a});break;case"=":E(r),o(e,{TAG:17,_0:a});break;case"?":E(r),o(e,{TAG:20,_0:a});break;case"[":E(r),o(e,{TAG:9,_0:a});break;case"]":E(r),o(e,{TAG:10,_0:a});break;case"{":E(r),o(e,{TAG:11,_0:a});break;case"}":E(r),o(e,{TAG:12,_0:a});break;case"~":E(r),o(e,{TAG:19,_0:a});break;default:hn.test(i)?o(e,yn(r,a)):gn.test(i)?o(e,{TAG:14,_0:a,_1:Vr(r,he)}):te(a,n,i)}f===1&&o(e,{TAG:3,_0:a,_1:mn(r,n)})}}function ye(r,e){for(var n={str:e,position:0},t=L(void 0),u=sr(n,t);;){var a=u;switch(a){case 0:var i=n.position;Ur(n)==="~"&&(o(t,{TAG:19,_0:n.position}),E(n)),o(t,{TAG:22,_0:i}),ge(n,t,r,"}");var f=pe(n);if(f!=="}")return lr(n.position,r,f,"}");u=sr(n,t);continue;case 1:ge(n,t,r,"%");var l=pe(n);if(l!=="}")return lr(n.position,r,l,"}");u=sr(n,t);continue;case 2:var c=n.position;o(t,{TAG:1,_0:c,_1:_n(n,r)}),u=sr(n,t);continue;case 3:return o(t,{TAG:23,_0:n.position}),{tokens:t,name:r}}}}function _r(r){return Ae(r.tokens)}function v(r){return me(r.tokens)}function h(r){return r.name}var Ln=fr("Caml_js_exceptions.Error");function dr(r){return Yr(r)?r:{RE_EXN_ID:Ln,_1:r}}function S(r,e){switch(r.TAG|0){case 2:return{NAME:"String",VAL:[r._0,r._1]};case 3:return{NAME:"Number",VAL:[r._0,r._1]};case 4:return{NAME:"True",VAL:r._0};case 5:return{NAME:"False",VAL:r._0};case 6:return{NAME:"Null",VAL:r._0};case 9:var n=r._0,t=v(e);if(t.TAG===10)return{NAME:"Array",VAL:[n,[]]};var u=L(void 0);o(u,S(t,e));for(var a;;){var i=v(e);switch(i.TAG|0){case 7:var f=v(e);if(f.TAG===13){var l=v(e);if(l.TAG!==18)return y(l,h(e));var c=v(e);return c.TAG===10?{NAME:"ArrayWithTailBinding",VAL:[n,m(u),{NAME:"Binding",VAL:[l._0,l._1]}]}:y(c,h(e))}o(u,S(f,e)),a=void 0;continue;case 10:return{NAME:"Array",VAL:[n,m(u)]};default:return y(i,h(e))}}case 11:var s=r._0,_=v(e);if(_.TAG===12)return{NAME:"Object",VAL:[s,[]]};var d=L(void 0);o(d,Le(_,e));for(var p;;){var A=v(e);switch(A.TAG|0){case 7:o(d,Le(v(e),e)),p=void 0;continue;case 12:return{NAME:"Object",VAL:[s,m(d)]};default:return y(A,h(e))}}case 18:return{NAME:"Binding",VAL:[r._0,r._1]};default:return y(r,h(e))}}function Le(r,e){switch(r.TAG|0){case 2:var n=v(e);return n.TAG===8?[r._1,S(v(e),e)]:y(n,h(e));case 18:var t=r._1,u=_r(e);return u.TAG!==8?[t,{NAME:"Binding",VAL:[r._0,t]}]:(v(e),[t,S(v(e),e)]);default:return y(r,h(e))}}function Ee(r){for(var e=S(v(r),r),n=L(void 0),t;;){var u=_r(r);if(u.TAG!==7)return{_0:e,_1:m(n)};v(r),o(n,S(v(r),r)),t=void 0}}function Te(r){var e=v(r);return e.TAG===18?[e._0,e._1]:y(e,h(r))}function En(r){for(var e=Te(r),n=L(void 0),t;;){var u=_r(r);if(u.TAG!==7)return{_0:e,_1:m(n)};v(r),o(n,Te(r)),t=void 0}}function be(r,e,n){switch(r.TAG|0){case 2:return{TAG:2,_0:r._1,_1:n};case 3:return{TAG:3,_0:r._1,_1:n};case 18:return{TAG:0,_0:r._0,_1:r._1,_2:n};default:return y(r,h(e))}}function Be(r){var e=v(r);switch(e.TAG|0){case 14:return{TAG:1,_0:e._0,_1:e._1};case 21:return be(v(r),r,0);default:return be(e,r,1)}}function Tn(r){for(var e=Be(r),n=L(void 0),t;;){var u=v(r);switch(u.TAG|0){case 0:case 19:return[u,{_0:e,_1:m(n)}];case 20:o(n,Be(r)),t=void 0;continue;default:return y(u,h(r))}}}function bn(r){switch(r.TAG|0){case 15:return!0;case 18:return r._1==="with";default:return!1}}function Bn(r){return r.TAG===23}function we(r){return r.TAG===15}function Ar(r,e,n){for(var t=L(void 0),u=r;;){var a=u;if(n(a))return[a,m(t)];switch(a.TAG|0){case 0:var i=a._1,f=v(e);if(f.TAG===19){o(t,{TAG:0,_0:i,_1:1}),u=v(e);continue}o(t,{TAG:0,_0:i,_1:3}),u=f;continue;case 1:u=v(e);continue;case 14:o(t,wn(a._0,a._1,e)),u=v(e);continue;case 18:var l=a._0;switch(a._1){case"map":var c=S(v(e),e),s=c.NAME;if(!(s==="Array"||s==="ArrayWithTailBinding"||s==="Binding"))return ue(c,h(e));var _=Me(e,"map");o(t,{TAG:3,_0:l,_1:c,_2:_}),u=v(e);continue;case"match":var d=En(e),p=Me(e,"match");o(t,{TAG:2,_0:l,_1:d,_2:p}),u=v(e);continue;default:return y(a,h(e))}case 19:var A=v(e);if(A.TAG!==0)return y(A,h(e));var T=A._1,M=v(e);if(M.TAG===19){o(t,{TAG:0,_0:T,_1:2}),u=v(e);continue}o(t,{TAG:0,_0:T,_1:0}),u=M;continue;case 22:var G=Tn(e);o(t,{TAG:1,_0:a._0,_1:G[1]}),u=G[0];continue;default:return y(a,h(e))}}}function Ce(r){for(var e=Ee(r),n=L(void 0),t;;){var u=v(r);if(u.TAG===18&&u._1==="with"){o(n,Ee(r)),t=void 0;continue}var a=Ar(u,r,bn);return[a[0],{patterns:{_0:e,_1:m(n)},ast:a[1]}]}}function Me(r,e){var n=v(r);if(n.TAG!==18)return y(n,h(r));if(n._1!=="with")return y(n,h(r));for(var t=Ce(r),u=t[1],a=L(void 0),i=t[0];;){var f=i;if(f.TAG===15){var l=v(r);return l.TAG===18&&l._1===e?{_0:u,_1:m(a)}:y(l,h(r))}var c=Ce(r);o(a,c[1]),i=c[0]}}function wn(r,e,n){var t=Mn(n),u=t[2],a=t[1],i=t[0];if(i.TAG===15)return{TAG:4,loc:r,name:e,props:m(a),children:m(u)};var f=Ar(i,n,we),l=v(n);return l.TAG===14&&e===l._1?(o(u,["Children",{TAG:1,_0:f[1]}]),{TAG:4,loc:r,name:e,props:m(a),children:m(u)}):y(l,h(n))}function Mn(r){for(var e=L(void 0),n=L(void 0),t=v(r);;){var u=t;switch(u.TAG|0){case 14:var a=u._1,i=v(r);if(i.TAG===17){var f=v(r);switch(f.TAG|0){case 14:o(n,[a,{TAG:0,_0:f._1}]),t=v(r);continue;case 16:var l=Ar(v(r),r,we),c=v(r);if(c.TAG!==16)return y(c,h(r));o(n,[a,{TAG:1,_0:l[1]}]),t=v(r);continue;default:return y(f,h(r))}}else{o(n,[a,{TAG:0,_0:a}]),t=i;continue}case 18:var s=u._1,_=v(r);if(_.TAG===17){var d=S(v(r),r);o(e,[s,d]),t=v(r);continue}o(e,[s,{NAME:"Binding",VAL:[u._0,s]}]),t=_;continue;default:return[u,e,n]}}}function Ge(r,e){try{var n=ye(r,e),t=Ar(v(n),n,Bn);return R.make({NAME:"data",VAL:{ast:t[1],name:r}})}catch(a){var u=dr(a);return u.RE_EXN_ID===V?R.make({NAME:"errors",VAL:u._1}):R.make({NAME:"errors",VAL:se(u,r)})}}function Cn(r,e){var n=Ge(r,e);return function(t,u,a){return t.render(n,u,a)}}function Gn(r,e){return Ge(e,r)}function xn(r,e){return Cn(e,r)}var Nr={makeAst:Gn,make:xn};var Or={};Ze(Or,{Async:()=>rt,make:()=>qn});function Q(r,e){if(e in r)return b(r[e])}function nr(r){var e=typeof r;return e==="string"?{TAG:0,_0:r}:e==="number"?{TAG:1,_0:r}:e==="boolean"?r===!0?1:0:r===null?2:Array.isArray(r)?{TAG:3,_0:r}:{TAG:2,_0:r}}function z(r,e){return r.TAG===0?{TAG:0,_0:e(r._0)}:{TAG:1,_0:r._0}}function xe(r,e){return r.TAG===0?e(r._0):{TAG:1,_0:r._0}}function K(r){return r!==void 0?r.h:0}function N(r,e,n,t){var u=K(r),a=K(t);return{k:e,v:n,h:u>=a?u+1|0:a+1|0,l:r,r:t}}function kr(r,e){return{k:r,v:e,h:1,l:void 0,r:void 0}}function Sr(r,e){return r.v===e?r:{k:r.k,v:e,h:r.h,l:r.l,r:r.r}}function mr(r,e,n,t){var u=r!==void 0?r.h:0,a=t!==void 0?t.h:0;if(u>(a+2|0)){var i=r.l,f=r.r;return K(i)>=K(f)?N(i,r.k,r.v,N(f,e,n,t)):N(N(i,r.k,r.v,f.l),f.k,f.v,N(f.r,e,n,t))}if(a<=(u+2|0))return{k:e,v:n,h:u>=a?u+1|0:a+1|0,l:r,r:t};var l=t.l,c=t.r;return K(c)>=K(l)?N(N(r,e,n,l),t.k,t.v,c):N(N(r,e,n,l.l),l.k,l.v,N(l.r,t.k,t.v,c))}function Qr(r,e){for(;;){var n=r;if(n===void 0)return;Qr(n.l,e),e(n.k,n.v),r=n.r}}function Ue(r,e){for(;;){var n=r;if(n===void 0)return!1;var t=n.k;if(e===t)return!0;r=e<t?n.l:n.r}}function pr(r,e,n){if(r===void 0)return kr(e,n);var t=r.k;if(e===t)return Sr(r,n);var u=r.v;return e<t?mr(pr(r.l,e,n),t,u,r.r):mr(r.l,t,u,pr(r.r,e,n))}var Ve=Ue;var Ne=Qr;function Dr(r,e){for(var n=L(void 0),t=0;;){var u=t,a=U(r,u);if(a===void 0)return{TAG:0,_0:n};var i=e(w(a));if(i.TAG!==0)return i;o(n,i._0),t=u+1|0}}function hr(r,e,n){var t=r.NAME;if(t==="Object")return z(Dr(r.VAL[1],function(f){var l=f[0];return z(hr(f[1],e,n),function(c){return[l,c]})}),function(f){var l={};return cr(f,function(c){l[c[0]]=c[1]}),l});if(t!=="Binding")return t==="False"?{TAG:0,_0:!1}:t==="Array"||t==="ArrayWithTailBinding"?z(ke(r,e,n),function(f){return f}):t==="Null"?{TAG:0,_0:null}:t==="True"?{TAG:0,_0:!0}:{TAG:0,_0:r.VAL[1]};var u=r.VAL,a=u[1],i=Q(e,a);return i!==void 0?{TAG:0,_0:w(i)}:{TAG:1,_0:Br(u[0],a,n)}}function ke(r,e,n){if(r.NAME==="Array")return z(Dr(r.VAL[1],function(c){return hr(c,e,n)}),m);var t=r.VAL,u=t[2].VAL,a=u[1],i=Q(e,a);if(i===void 0)return{TAG:1,_0:Br(u[0],a,n)};var f=nr(w(i));if(typeof f=="number")return{TAG:1,_0:br(f,r,a,n)};if(f.TAG!==3)return{TAG:1,_0:br(f,r,a,n)};var l=f._0;return z(Dr(t[1],function(c){return hr(c,e,n)}),function(c){return Kr(m(c),l)})}function Se(r,e,n,t){return e==="_"?{TAG:0,_0:r}:Ve(r,e)?{TAG:1,_0:{TAG:1,loc:t,binding:e}}:{TAG:0,_0:pr(r,e,n)}}function Ir(r,e,n){var t=nr(e),u=r.NAME;if(u==="Object"){var a=r.VAL[1];if(a.length!==0){if(typeof t=="number")return t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}};if(t.TAG===2)for(var i=t._0,f=n,l=0;;){var c=l,s=f,_=U(a,c);if(_===void 0)return{TAG:0,_0:s};var d=Q(i,_[0]);if(d===void 0)return{TAG:1,_0:0};var p=Ir(_[1],w(d),s);if(p.TAG!==0)return p;l=c+1|0,f=p._0}else return{TAG:1,_0:{TAG:0,data:t,pattern:r}}}else return typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===2?Object.keys(t._0).length===0?{TAG:0,_0:n}:{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}}if(u==="Binding"){var A=r.VAL;return Se(n,A[1],e,A[0])}if(u==="Number")return typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===1?r.VAL[1]===t._0?{TAG:0,_0:n}:{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}};if(u==="False"){if(typeof t!="number")return{TAG:1,_0:{TAG:0,data:t,pattern:r}};switch(t){case 0:return{TAG:0,_0:n};case 1:case 2:return{TAG:1,_0:0}}}else if(u==="ArrayWithTailBinding"){var T=r.VAL,M=T[2].VAL,G=M[1],D=M[0],W=T[1];if(typeof t=="number")return t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}};if(t.TAG!==3)return{TAG:1,_0:{TAG:0,data:t,pattern:r}};var P=t._0;return xe(Qe(W,P,n),function(tr){return Se(tr,G,Hr(P,W.length),D)})}else{if(u==="Null")return typeof t=="number"&&t>=2?{TAG:0,_0:n}:{TAG:1,_0:0};if(u==="True"){if(typeof t!="number")return{TAG:1,_0:{TAG:0,data:t,pattern:r}};switch(t){case 1:return{TAG:0,_0:n};case 0:case 2:return{TAG:1,_0:0}}}else{if(u!=="Array")return typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===0?r.VAL[1]===t._0?{TAG:0,_0:n}:{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}};var Z=r.VAL[1];return Z.length!==0?typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===3?Qe(Z,t._0,n):{TAG:1,_0:{TAG:0,data:t,pattern:r}}:typeof t=="number"?t===2?{TAG:1,_0:0}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}:t.TAG===3?t._0.length!==0?{TAG:1,_0:0}:{TAG:0,_0:n}:{TAG:1,_0:{TAG:0,data:t,pattern:r}}}}}function Qe(r,e,n){for(var t=n,u=0;;){var a=u,i=t,f=U(r,a);if(f===void 0)return{TAG:0,_0:i};var l=U(e,a);if(l===void 0)return{TAG:1,_0:0};var c=Ir(f,w(l),i);if(c.TAG!==0)return c;u=a+1|0,t=c._0}}function kn(r,e){for(var n=e._1,t=r._1,u=r._0,a=e._0,i,f=0;;){var l=f,c=i,s=a,_=u,d=Ir(_,s,c);if(d.TAG!==0)return d;var p=d._0,A=U(t,l),T=U(n,l);if(A!==void 0){if(T===void 0)return{TAG:1,_0:1};f=l+1|0,i=p,a=w(T),u=A;continue}if(T!==void 0)return{TAG:1,_0:1};var M={};return Ne(p,function(G){return function(D,W){G[D]=W}}(M)),{TAG:0,_0:M}}}function Sn(r,e){for(var n=r.f,t=r.patterns,u=t._1,a=t._0,i=0;;){var f=i,l=a,c=kn(l,e);if(c.TAG===0)return{TAG:0,_0:n(c._0)};if(c._0!==0)return c;var s=U(u,f);if(s===void 0)return{TAG:1,_0:0};i=f+1|0,a=s}}function Qn(r,e){for(var n=r._1,t=r._0,u=0;;){var a=u,i=t,f=Sn(i,e);if(f.TAG===0||f._0!==0)return f;var l=U(n,a);if(l===void 0)return{TAG:1,_0:0};u=a+1|0,t=l}}function Dn(r){switch(r){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&apos;";case"/":return"&#x2F;";case"<":return"&lt;";case"=":return"&#x3D;";case">":return"&gt;";case"`":return"&#x60;";default:return r}}function Rr(r,e){if(r)for(var n=0,t="";;){var u=t,a=n,i=e.charAt(a);if(i==="")return u;t=u+Dn(i),n=a+1|0}else return e}function jr(r,e){var n=Q(r,e);return n!==void 0?w(n):null}function In(r,e){var n=nr(jr(r,e));if(typeof n=="number")return{TAG:1,_0:n};switch(n.TAG|0){case 0:return{TAG:0,_0:n._0};case 1:return{TAG:0,_0:String(n._0)};default:return{TAG:1,_0:n}}}function Rn(r){return function(e){return e._1.length!==0?e:{_0:e._0,_1:[{NAME:"Binding",VAL:[r,"_"]}]}}}function De(r,e,n,t){var u=Qn(r,e);if(u.TAG===0)return u;var a=u._0;return typeof a=="number"?a===0?{TAG:1,_0:le(n,t)}:{TAG:1,_0:oe(n,t)}:a.TAG===0?{TAG:1,_0:ie(a.data,a.pattern,t)}:{TAG:1,_0:fe(a.loc,a.binding,t)}}function Ie(r){for(var e=0;;){var n=e,t=r.charAt(n);switch(t){case"	":case`
`:case"\r":case" ":e=n+1|0;continue;default:return r.slice(n)}}}function Re(r){for(var e=r.length;;){var n=e,t=r.charAt(n-1|0);switch(t){case"	":case`
`:case"\r":case" ":e=n-1|0;continue;default:return r.slice(0,n)}}}function jn(r,e,n,t,u,a,i){for(var f=r,l=0;;){var c=l,s=f;switch(s.TAG|0){case 0:var _=s._1,d=In(n,_);if(d.TAG===0)return a.return(Rr(s._2,d._0));var p=d._0,A=U(e,c);if(typeof p=="number"&&p>=2&&A!==void 0){l=c+1|0,f=A;continue}return i([ce(s._0,_,p,t)]);case 1:var T=s._1,M=Q(u,T);if(M!==void 0)return w(M);var G=U(e,c);if(G===void 0)return i([wr(s._0,T,t)]);l=c+1|0,f=G;continue;case 2:return a.return(Rr(s._1,s._0));case 3:return a.return(Rr(s._1,String(s._0)))}}}function H(r,e,n,t,u,a,i,f){var l=t.stack,c=t.components,s=u(t),_=L(void 0);return k(r,function(d){switch(d.TAG|0){case 0:var p=d._0,A;switch(d._1){case 0:A=Ie(p);break;case 1:A=Re(p);break;case 2:A=Ie(Re(p));break;case 3:A=p;break}return o(_,s.return(A));case 1:var T=d._1;return o(_,jn(T._0,T._1,e,l,n,s,a));case 2:var M=rr.map(d._2,function(B){var x=B.ast;return{patterns:B.patterns,f:function(I){return H(x,Object.assign({},e,I),n,{components:t.components,stack:{hd:0,tl:l}},u,a,i,f)}}}),G=rr.map(d._1,function(B){return jr(e,B[1])}),D=De(M,G,d._0,l);return D.TAG===0?xr(D._0,_):o(_,a([D._0]));case 3:var W=d._2,P=d._1,Z=d._0,tr=P.NAME,X;if(tr==="Array"||tr==="ArrayWithTailBinding")X=ke(P,e,l);else{var $r=P.VAL,Wr=$r[1],Fe=$r[0],ur=nr(jr(e,Wr));X=typeof ur=="number"||ur.TAG!==3?{TAG:1,_0:ve(Fe,Wr,ur,l)}:{TAG:0,_0:ur._0}}return X.TAG===0?Zr(X._0,function(B,x){var I=rr.map(W,function(Y){var ze=Y.ast;return{patterns:rr.map(Y.patterns,Rn(Z)),f:function(Ke){return H(ze,Object.assign({},e,Ke),n,{components:t.components,stack:{hd:{TAG:2,_0:B},tl:{hd:1,tl:l}}},u,a,i,f)}}}),J=De(I,{_0:x,_1:[B]},Z,l);return J.TAG===0?xr(J._0,_):o(_,a([J._0]))}):o(_,a([X._0]));case 4:var gr=d.name,Pr=d.loc,Jr=Q(c,gr);if(Jr===void 0)return o(_,a([ae(Pr,gr,l)]));var Fr={},yr={},ar=L(void 0);return k(d.children,function(B){var x=B[1],I=B[0];if(x.TAG===0){var J=x._0,Y=Q(n,J);if(Y!==void 0){yr[I]=w(Y);return}else return o(ar,wr(Pr,J,l))}yr[I]=f(H(x._0,e,n,{components:t.components,stack:{hd:{TAG:1,component:gr,section:I},tl:l}},u,a,i,f))}),k(d.props,function(B){var x=hr(B[1],e,l);if(x.TAG!==0)return o(ar,x._0);Fr[B[0]]=x._0}),er(ar)?o(_,i(function(){return Jr(s,Fr,yr)},function(B){return a([_e(B,l)])})):o(_,a(m(ar)))}}),_}function On(r){return Promise.resolve({NAME:"data",VAL:r})}function $n(r){return Promise.resolve({NAME:"errors",VAL:r})}function Wn(r,e){return r().catch(function(n){return e(n)})}function Pn(r,e){return r.then(function(n){return n.NAME==="errors"?Promise.resolve(n):Promise.resolve({NAME:"data",VAL:e(n.VAL)})})}function Jn(r,e){return r.then(function(n){return n.NAME==="errors"?Promise.resolve(n):e(n.VAL)})}function Fn(r){var e={contents:""},n=L(void 0);return k(r,function(t){if(t.NAME==="errors")return k(t.VAL,function(u){return o(n,u)});e.contents=e.contents+t.VAL}),er(n)?Promise.resolve({NAME:"data",VAL:e.contents}):Promise.resolve({NAME:"errors",VAL:m(n)})}function je(r){return Promise.all(m(r)).then(Fn)}function Oe(r){var e=r.stack,n=r.components;return{render:function(t,u,a){var i=R.validate(t);if(i===void 0)return Promise.resolve({NAME:"errors",VAL:[Mr(e)]});if(i.NAME==="errors")return Promise.resolve({NAME:"errors",VAL:[i.VAL]});var f=i.VAL;return je(H(f.ast,u,a,{components:n,stack:{hd:{TAG:0,_0:f.name},tl:e}},Oe,$n,Wn,je))},return:On,error:function(t){return Promise.resolve({NAME:"errors",VAL:[Cr(t,e)]})},mapChild:Pn,flatMapChild:Jn}}function zn(r){return Oe({components:r,stack:0})}function Kn(r){return{NAME:"data",VAL:r}}function Hn(r){return{NAME:"errors",VAL:r}}function Zn(r,e){try{return r()}catch(t){var n=dr(t);return e(n)}}function Xn(r,e){return r.NAME==="errors"?r:{NAME:"data",VAL:e(r.VAL)}}function Yn(r,e){return r.NAME==="errors"?r:e(r.VAL)}function $e(r){var e={contents:""},n=L(void 0);return cr(r,function(t){if(t.NAME==="errors")return k(t.VAL,function(u){return o(n,u)});e.contents=e.contents+t.VAL}),er(n)?{NAME:"data",VAL:e.contents}:{NAME:"errors",VAL:m(n)}}function We(r){var e=r.stack,n=r.components;return{render:function(t,u,a){var i=R.validate(t);if(i===void 0)return{NAME:"errors",VAL:[Mr(e)]};if(i.NAME==="errors")return{NAME:"errors",VAL:[i.VAL]};var f=i.VAL;return $e(H(f.ast,u,a,{components:n,stack:{hd:{TAG:0,_0:f.name},tl:e}},We,Hn,Zn,$e))},return:Kn,error:function(t){return{NAME:"errors",VAL:[Cr(t,e)]}},mapChild:Xn,flatMapChild:Yn}}function qn(r){return We({components:r,stack:0})}var rt={make:zn};var et=Nr.makeAst,nt=Nr.make,Pe={makeAst:et,make:nt},Je=Or;window.onload=function(e){var n=document.getElementById("props"),t=document.getElementById("source"),u=document.getElementById("source-is-dirty"),a=document.getElementById("props-is-dirty");function i(_){_.textContent="*"}function f(_){_.textContent=""}n.oninput=function(_){i(a)},t.oninput=function(_){i(u)},n.value=JSON.stringify({name:null,objects:[{name:"sky",color:"blue"},{name:"grass",color:"purple"},{name:"air"}]},null,2),t.value=`Hello {{ name ? "dear user" }},

{% map objects with {name, color} ~%}
  Have you noticed the {{ name }} is {{ color }} today?
{% match name, color
   with "sky", "blue"
   with "grass", "green" ~%}
  That's an ordinary color for it.
{% with _, _ ~%}
  That seems odd.
{% /match %}
{% with {name} ~%}
  The {{ name }}, I suppose, has no color.
{%~ /map %}
`;var l=Je.make({}),c=document.getElementById("result");function s(_){try{var d=JSON.parse(n.value),p=Pe.make(t.value,"playground"),A=p(l,d,{});A.NAME==="errors"?c.value=`Errors:
`+JSON.stringify(A.VAL,null,2):c.value=A.VAL}catch(T){c.value=T.message}f(a),f(u)}document.getElementById("render").onclick=s,s()};
//# sourceMappingURL=playground.js.map
